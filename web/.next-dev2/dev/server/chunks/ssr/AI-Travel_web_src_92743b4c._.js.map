{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/MapView.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\ntype Marker = { position: [number, number]; title?: string };\n\ntype MapViewProps = {\n  center?: [number, number];\n  zoom?: number;\n  markers?: Marker[];\n  routePath?: [number, number][]; // ÊäòÁ∫øË∑ØÂæÑÔºàlng,latÔºâÊï∞ÁªÑ\n  className?: string;\n};\n\nexport default function MapView({ center = [116.397428, 39.90923], zoom = 12, markers = [], routePath, className = \"\" }: MapViewProps) {\n  const ref = useRef<HTMLDivElement | null>(null);\n  const [ready, setReady] = useState(false);\n  const mapRef = useRef<any>(null);\n\n  // Lazy init: wait for AMap to be available even if script loads after render\n  useEffect(() => {\n    let timer: any;\n    const tryInit = () => {\n      const amap = (window as any).AMap;\n      if (!amap || !ref.current) {\n        setReady(false);\n        return;\n      }\n      if (!mapRef.current) {\n        setReady(true);\n        mapRef.current = new amap.Map(ref.current, {\n          zoom,\n          center,\n          viewMode: \"2D\",\n        });\n      }\n      // update overlays\n      try { mapRef.current.clearMap(); } catch {}\n      markers.forEach((m) => {\n        const marker = new amap.Marker({ position: m.position, title: m.title });\n        mapRef.current.add(marker);\n      });\n      if (routePath && routePath.length >= 2) {\n        const polyline = new amap.Polyline({\n          path: routePath,\n          strokeColor: \"#2563eb\",\n          strokeWeight: 5,\n          strokeOpacity: 0.9,\n        });\n        mapRef.current.add(polyline);\n        try { mapRef.current.setFitView([polyline]); } catch {}\n      } else {\n        try { mapRef.current.setZoomAndCenter(zoom, center); } catch {}\n      }\n    };\n    // attempt immediately and then poll briefly if not ready\n    tryInit();\n    if (!mapRef.current) {\n      timer = setInterval(() => {\n        tryInit();\n        if (mapRef.current) clearInterval(timer);\n      }, 200);\n    }\n    return () => {\n      if (timer) clearInterval(timer);\n      try { mapRef.current?.destroy?.(); } catch {}\n      mapRef.current = null;\n    };\n  }, [center, zoom, markers, routePath]);\n\n  return (\n    <div className={[\"relative overflow-hidden rounded-xl border border-gray-200\", className].join(\" \")}\n      style={{ height: \"100%\", width: \"100%\" }}\n    >\n      {!ready && (\n        <div className=\"absolute inset-0 flex items-center justify-center text-sm text-gray-500\">\n          Âú∞ÂõæÊú™Âä†ËΩΩÔºåËØ∑ÈÖçÁΩÆ `NEXT_PUBLIC_AMAP_KEY`\n        </div>\n      )}\n      <div ref={ref} className=\"w-full h-full\" />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AACA;AADA;;;AAae,SAAS,QAAQ,EAAE,SAAS;IAAC;IAAY;CAAS,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,EAAE,SAAS,EAAE,YAAY,EAAE,EAAgB;IACnI,MAAM,MAAM,IAAA,sOAAM,EAAwB;IAC1C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wOAAQ,EAAC;IACnC,MAAM,SAAS,IAAA,sOAAM,EAAM;IAE3B,6EAA6E;IAC7E,IAAA,yOAAS,EAAC;QACR,IAAI;QACJ,MAAM,UAAU;YACd,MAAM,OAAO,AAAC,OAAe,IAAI;YACjC,IAAI,CAAC,QAAQ,CAAC,IAAI,OAAO,EAAE;gBACzB,SAAS;gBACT;YACF;YACA,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,SAAS;gBACT,OAAO,OAAO,GAAG,IAAI,KAAK,GAAG,CAAC,IAAI,OAAO,EAAE;oBACzC;oBACA;oBACA,UAAU;gBACZ;YACF;YACA,kBAAkB;YAClB,IAAI;gBAAE,OAAO,OAAO,CAAC,QAAQ;YAAI,EAAE,OAAM,CAAC;YAC1C,QAAQ,OAAO,CAAC,CAAC;gBACf,MAAM,SAAS,IAAI,KAAK,MAAM,CAAC;oBAAE,UAAU,EAAE,QAAQ;oBAAE,OAAO,EAAE,KAAK;gBAAC;gBACtE,OAAO,OAAO,CAAC,GAAG,CAAC;YACrB;YACA,IAAI,aAAa,UAAU,MAAM,IAAI,GAAG;gBACtC,MAAM,WAAW,IAAI,KAAK,QAAQ,CAAC;oBACjC,MAAM;oBACN,aAAa;oBACb,cAAc;oBACd,eAAe;gBACjB;gBACA,OAAO,OAAO,CAAC,GAAG,CAAC;gBACnB,IAAI;oBAAE,OAAO,OAAO,CAAC,UAAU,CAAC;wBAAC;qBAAS;gBAAG,EAAE,OAAM,CAAC;YACxD,OAAO;gBACL,IAAI;oBAAE,OAAO,OAAO,CAAC,gBAAgB,CAAC,MAAM;gBAAS,EAAE,OAAM,CAAC;YAChE;QACF;QACA,yDAAyD;QACzD;QACA,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,QAAQ,YAAY;gBAClB;gBACA,IAAI,OAAO,OAAO,EAAE,cAAc;YACpC,GAAG;QACL;QACA,OAAO;YACL,IAAI,OAAO,cAAc;YACzB,IAAI;gBAAE,OAAO,OAAO,EAAE;YAAa,EAAE,OAAM,CAAC;YAC5C,OAAO,OAAO,GAAG;QACnB;IACF,GAAG;QAAC;QAAQ;QAAM;QAAS;KAAU;IAErC,qBACE,qQAAC;QAAI,WAAW;YAAC;YAA8D;SAAU,CAAC,IAAI,CAAC;QAC7F,OAAO;YAAE,QAAQ;YAAQ,OAAO;QAAO;;YAEtC,CAAC,uBACA,qQAAC;gBAAI,WAAU;0BAA0E;;;;;;0BAI3F,qQAAC;gBAAI,KAAK;gBAAK,WAAU;;;;;;;;;;;;AAG/B","debugId":null}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/VoiceButton.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\ntype VoiceButtonProps = {\n  onTranscribe?: (text: string) => void;\n  className?: string;\n};\n\ntype State = \"idle\" | \"recording\" | \"transcribing\" | \"done\" | \"error\";\n\nexport default function VoiceButton({ onTranscribe, className = \"\" }: VoiceButtonProps) {\n  const [state, setState] = useState<State>(\"idle\");\n  const [message, setMessage] = useState<string>(\"\");\n  const [mode] = useState<\"service\" | \"iflytek\" | \"browser\">(\"iflytek\");\n  const streamRef = useRef<MediaStream | null>(null);\n  const recRef = useRef<MediaRecorder | null>(null);\n  const chunksRef = useRef<BlobPart[]>([]);\n  const wsRef = useRef<WebSocket | null>(null);\n  const audioCtxRef = useRef<AudioContext | null>(null);\n  const processorRef = useRef<ScriptProcessorNode | null>(null);\n  const textRef = useRef<string>(\"\");\n  const tokensRef = useRef<string[]>([]); // Á¥ØÁßØËØÜÂà´ËØçÂÖÉÔºåÊîØÊåÅ wpgs Âä®ÊÄÅ‰øÆÊ≠£\n\n  // Â∞Ü Float32 PCM ËΩ¨‰∏∫ 16bit PCM Âπ∂ base64\n  const floatTo16kBase64 = (input: Float32Array, inputSampleRate: number, targetRate = 16000) => {\n    let samples = input;\n    if (inputSampleRate !== targetRate) {\n      const ratio = inputSampleRate / targetRate;\n      const newLength = Math.round(input.length / ratio);\n      const resampled = new Float32Array(newLength);\n      for (let i = 0; i < newLength; i++) {\n        const idx = Math.round(i * ratio);\n        resampled[i] = input[Math.min(idx, input.length - 1)];\n      }\n      samples = resampled;\n    }\n    const buffer = new ArrayBuffer(samples.length * 2);\n    const view = new DataView(buffer);\n    for (let i = 0; i < samples.length; i++) {\n      let s = Math.max(-1, Math.min(1, samples[i]));\n      view.setInt16(i * 2, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n    }\n    const u8 = new Uint8Array(buffer);\n    let binary = \"\";\n    const chunkSize = 0x8000;\n    for (let i = 0; i < u8.length; i += chunkSize) {\n      binary += String.fromCharCode.apply(null, Array.from(u8.subarray(i, i + chunkSize)) as any);\n    }\n    return btoa(binary);\n  };\n\n  const parseIatText = (msg: any) => {\n    try {\n      const ws = msg?.data?.result?.ws || [];\n      const parts: string[] = [];\n      for (const w of ws) {\n        const cw = w?.cw || [];\n        if (cw[0]?.w) parts.push(cw[0].w);\n      }\n      return parts.join(\"\");\n    } catch {\n      return \"\";\n    }\n  };\n\n  const startIflytek = async () => {\n    try {\n      const signRes = await fetch(\"/api/voice/iflytek/sign\");\n      if (signRes.status === 501) {\n        setState(\"error\");\n        setMessage(\"Êú™ÈÖçÁΩÆËÆØÈ£ûÂØÜÈí•ÔºåËØ∑Âú® .env.local ÈÖçÁΩÆ IFLYTEK_APP_ID/KEY/SECRET\");\n        return;\n      }\n      const { wsUrl, appId } = await signRes.json();\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      streamRef.current = stream;\n      // ‰ΩøÁî®ÈªòËÆ§ËÆæÂ§áÈááÊ†∑ÁéáÔºåÈÅøÂÖçÈÉ®ÂàÜÊµèËßàÂô®‰∏çÊîØÊåÅÂº∫Âà∂ 16000 ÈááÊ†∑Áéá\n      const AC: any = (window as any).AudioContext || (window as any).webkitAudioContext;\n      const audioCtx = new AC();\n      audioCtxRef.current = audioCtx;\n      const source = audioCtx.createMediaStreamSource(stream);\n      const processor = audioCtx.createScriptProcessor(4096, 1, 1);\n      processorRef.current = processor;\n\n      const ws = new WebSocket(wsUrl);\n      wsRef.current = ws;\n      textRef.current = \"\";\n      setState(\"recording\");\n      setMessage(\"ÂΩïÈü≥‰∏≠ÔºàËÆØÈ£ûÔºâ...\");\n\n      ws.onopen = () => {\n        // ÂèëÈÄÅÂºÄÂßãÂ∏ß\n        const startFrame = {\n          common: { app_id: appId },\n          business: {\n            language: \"zh_cn\",\n            domain: \"iat\",\n            accent: \"mandarin\",\n            // ÂêØÁî®Âä®ÊÄÅ‰øÆÊ≠£‰ª•‰æøÂÆûÊó∂ËøîÂõûÁâáÊÆµ\n            dwa: \"wpgs\",\n            vad_eos: 5000,\n          },\n          data: {\n            status: 0,\n            format: \"audio/L16;rate=16000\",\n            encoding: \"raw\",\n            audio: \"\",\n          },\n        };\n        ws.send(JSON.stringify(startFrame));\n\n        processor.onaudioprocess = (e: AudioProcessingEvent) => {\n          const input = e.inputBuffer.getChannelData(0);\n          const base64 = floatTo16kBase64(input, audioCtx.sampleRate, 16000);\n          const frame = {\n            data: {\n              status: 1,\n              format: \"audio/L16;rate=16000\",\n              encoding: \"raw\",\n              audio: base64,\n            },\n          };\n          ws.send(JSON.stringify(frame));\n        };\n        source.connect(processor);\n        processor.connect(audioCtx.destination);\n        tokensRef.current = [];\n      };\n\n      ws.onmessage = async (ev: MessageEvent) => {\n        try {\n          let data: any;\n          if (typeof ev.data === \"string\") {\n            data = JSON.parse(ev.data);\n          } else if (ev.data instanceof Blob) {\n            data = JSON.parse(await ev.data.text());\n          } else if (ev.data instanceof ArrayBuffer) {\n            data = JSON.parse(new TextDecoder().decode(ev.data));\n          } else {\n            data = ev.data;\n          }\n          if (data.code !== 0) {\n            setState(\"error\");\n            setMessage(data.message || \"ËÆØÈ£ûËØÜÂà´ÈîôËØØ\");\n            return;\n          }\n          const status = data?.data?.status;\n          const result = data?.data?.result || {};\n          const wsArr = result.ws || [];\n          const pgs = result.pgs; // 'apd' ËøΩÂä† Êàñ 'rpl' ÊõøÊç¢\n          const rg = result.rg || []; // [start, end] 1-based\n\n          const words: string[] = [];\n          for (const w of wsArr) {\n            const cw = w?.cw || [];\n            if (cw[0]?.w) words.push(cw[0].w);\n          }\n\n          if (words.length) {\n            if (pgs === \"rpl\" && Array.isArray(rg) && rg.length === 2) {\n              const start = Math.max(0, Number(rg[0]) - 1);\n              const end = Math.min(tokensRef.current.length, Number(rg[1]));\n              tokensRef.current.splice(start, end - start, ...words);\n            } else {\n              tokensRef.current.push(...words);\n            }\n\n            const full = tokensRef.current.join(\"\");\n            setMessage(full);\n            textRef.current = full;\n\n            if (status === 2) {\n              setState(\"done\");\n              onTranscribe?.(full);\n              try { ws.close(); } catch {}\n            }\n          }\n        } catch (e: any) {\n          setState(\"error\");\n          setMessage(e?.message || \"ËÆØÈ£ûÊ∂àÊÅØËß£ÊûêÂ§±Ë¥•\");\n        }\n      };\n\n      ws.onerror = () => {\n        // ËøûÊé•Â§±Ë¥•Êó∂ÊèêÁ§∫Âπ∂‰øùÊåÅÈîôËØØÁä∂ÊÄÅÔºå‰∏çÂõûÈÄÄÔºå‰ª•Á°Æ‰øù‰ΩøÁî®ËÆØÈ£ûÊñπÊ°à\n        try {\n          source.disconnect();\n          processor.disconnect();\n          if (audioCtx.state !== \"closed\") audioCtx.close();\n          stream.getTracks().forEach(t => t.stop());\n        } catch {}\n        setState(\"error\");\n        setMessage(\"ËÆØÈ£ûËøûÊé•ÈîôËØØÔºåËØ∑Ê£ÄÊü•ÂØÜÈí•„ÄÅÁ≥ªÁªüÊó∂Èó¥ÊàñÁΩëÁªú\");\n      };\n\n      ws.onclose = (ev: CloseEvent) => {\n        if (textRef.current) {\n          setState(\"done\");\n          onTranscribe?.(textRef.current);\n        } else if (state === \"recording\") {\n          // Ëã•Ê≠£Âú®ÂΩïÈü≥Ë¢´ÂÖ≥Èó≠ÔºåÂàôÊÅ¢Â§ç‰∏∫Á©∫Èó≤\n          setState(\"idle\");\n          setMessage(\"Â∑≤ÂÅúÊ≠¢\");\n        }\n        // Ê∏ÖÁêÜËµÑÊ∫ê\n        try {\n          source.disconnect();\n          processor.disconnect();\n          if (audioCtx.state !== \"closed\") audioCtx.close();\n          stream.getTracks().forEach(t => t.stop());\n        } catch {}\n      };\n    } catch (e: any) {\n      setState(\"error\");\n      setMessage(e?.message || \"ËÆØÈ£ûÂêØÂä®Â§±Ë¥•\");\n    }\n  };\n\n  // ÊµèËßàÂô®ËØ≠Èü≥ËØÜÂà´ÂõûÈÄÄ\n  const startBrowserSpeech = () => {\n    const SR: any = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\n    if (!SR) {\n      setState(\"error\");\n      setMessage(\"ÊµèËßàÂô®‰∏çÊîØÊåÅ Web Speech API\");\n      return;\n    }\n    const recog = new SR();\n    recog.lang = \"zh-CN\";\n    recog.continuous = false;\n    recog.interimResults = false;\n    setState(\"recording\");\n    recog.onresult = (ev: any) => {\n      const text = ev.results?.[0]?.[0]?.transcript || \"\";\n      setState(\"done\");\n      setMessage(text);\n      onTranscribe?.(text);\n    };\n    recog.onerror = (e: any) => {\n      setState(\"error\");\n      setMessage(e?.message || \"ËØÜÂà´Â§±Ë¥•\");\n    };\n    recog.onend = () => {\n      if (state === \"recording\") setState(\"idle\");\n    };\n    recog.start();\n  };\n\n  const startRecording = async () => {\n    await startIflytek();\n  };\n\n  const stopRecording = () => {\n    // ÂèëÈÄÅÁªìÊùüÂ∏ßÔºàËã•ËøûÊé•Â∑≤ÊâìÂºÄÔºâ\n    try {\n      if (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\n        wsRef.current.send(\n          JSON.stringify({ data: { status: 2, format: \"audio/L16;rate=16000\", encoding: \"raw\", audio: \"\" } })\n        );\n      }\n    } catch {}\n\n    // ÂÅúÊ≠¢Èü≥È¢ëÂ§ÑÁêÜ‰∏éÂÖ≥Èó≠ËøûÊé•\n    try { if (processorRef.current) { (processorRef.current as any).onaudioprocess = null; processorRef.current.disconnect(); } } catch {}\n    try { if (audioCtxRef.current && audioCtxRef.current.state !== \"closed\") { audioCtxRef.current.close(); } } catch {}\n    // ÂÖÅËÆ∏ÊúçÂä°Á´ØËøîÂõûÊúÄÁªàÁªìÊûúÔºåÂÜçÂª∂ËøüÂÖ≥Èó≠ WebSocket\n    try {\n      if (wsRef.current) {\n        const ws = wsRef.current;\n        setTimeout(() => { try { if (ws.readyState === WebSocket.OPEN) ws.close(); } catch {} }, 800);\n      }\n    } catch {}\n\n    processorRef.current = null;\n    audioCtxRef.current = null;\n    wsRef.current = null;\n\n    // ÂÅúÊ≠¢È∫¶ÂÖãÈ£éÊµÅ\n    try { streamRef.current?.getTracks().forEach((t) => t.stop()); } catch {}\n    streamRef.current = null;\n\n    // Âàá‰∏∫‚ÄúËΩ¨ÂÜô‰∏≠‚ÄùÔºåÊèêÁ§∫Á®çÂêéÁîüÊàêË∑ØÁ∫ø\n    setState(\"transcribing\");\n    setMessage(\"Â∑≤ÂÅúÊ≠¢ÔºåÂ§ÑÁêÜ‰∏≠...\");\n  };\n\n  useEffect(() => () => stopRecording(), []);\n\n  return (\n    <div className={[\"flex items-center gap-2\", className].join(\" \")}>\n      <button\n        className=\"rounded bg-black px-3 py-1.5 text-white disabled:opacity-60\"\n        onClick={state === \"recording\" ? stopRecording : startRecording}\n      >\n        {state === \"recording\" ? \"ÂÅúÊ≠¢\" : \"ËØ≠Èü≥ËæìÂÖ•\"}\n      </button>\n      {/* Âõ∫ÂÆö‰ΩøÁî®ËÆØÈ£ûËØÜÂà´Ôºå‰∏çÂ±ïÁ§∫Ê®°ÂºèÈÄâÊã© */}\n      <span className=\"text-xs text-zinc-500\">{message}</span>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 449, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/Card.tsx"],"sourcesContent":["\"use client\";\nimport React from \"react\";\n\ntype CardProps = {\n  title?: string;\n  actions?: React.ReactNode;\n  className?: string;\n  children?: React.ReactNode;\n};\n\nexport default function Card({ title, actions, className = \"\", children }: CardProps) {\n  return (\n    <div className={[\"rounded-xl border border-gray-200 bg-white shadow-sm\", className].join(\" \")}> \n      {(title || actions) && (\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-100\">\n          <h3 className=\"text-sm font-semibold text-gray-900\">{title}</h3>\n          {actions}\n        </div>\n      )}\n      <div className=\"p-4\">{children}</div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;;AAUe,SAAS,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,YAAY,EAAE,EAAE,QAAQ,EAAa;IAClF,qBACE,qQAAC;QAAI,WAAW;YAAC;YAAwD;SAAU,CAAC,IAAI,CAAC;;YACtF,CAAC,SAAS,OAAO,mBAChB,qQAAC;gBAAI,WAAU;;kCACb,qQAAC;wBAAG,WAAU;kCAAuC;;;;;;oBACpD;;;;;;;0BAGL,qQAAC;gBAAI,WAAU;0BAAO;;;;;;;;;;;;AAG5B","debugId":null}},
    {"offset": {"line": 500, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/Badge.tsx"],"sourcesContent":["\"use client\";\nimport React from \"react\";\n\ntype BadgeProps = {\n  children: React.ReactNode;\n  variant?: \"default\" | \"success\" | \"warning\" | \"gray\";\n  className?: string;\n};\n\nconst variants: Record<NonNullable<BadgeProps[\"variant\"]>, string> = {\n  default: \"bg-indigo-50 text-indigo-700 ring-indigo-200\",\n  success: \"bg-emerald-50 text-emerald-700 ring-emerald-200\",\n  warning: \"bg-amber-50 text-amber-700 ring-amber-200\",\n  gray: \"bg-gray-100 text-gray-700 ring-gray-200\",\n};\n\nexport default function Badge({ children, variant = \"default\", className = \"\" }: BadgeProps) {\n  return (\n    <span\n      className={[\n        \"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset\",\n        variants[variant],\n        className,\n      ].join(\" \")}\n    >\n      {children}\n    </span>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;;AASA,MAAM,WAA+D;IACnE,SAAS;IACT,SAAS;IACT,SAAS;IACT,MAAM;AACR;AAEe,SAAS,MAAM,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,YAAY,EAAE,EAAc;IACzF,qBACE,qQAAC;QACC,WAAW;YACT;YACA,QAAQ,CAAC,QAAQ;YACjB;SACD,CAAC,IAAI,CAAC;kBAEN;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 531, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/BudgetPanel.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useMemo, useState } from \"react\";\n\ntype PriceRange = [number, number];\ntype DiningItem = { name: string; priceRange?: PriceRange };\ntype LodgingItem = { name: string; price?: number };\ntype TransportSummary = { mode?: string; timeEstimate?: number; priceEstimate?: number };\ntype AttractionItem = { name: string; ticket?: number | string };\ntype PlanItem = { id: string; time?: string; title: string; note?: string };\ntype PlanDay = {\n  date: string;\n  items: PlanItem[];\n  dining?: DiningItem[];\n  lodging?: LodgingItem[];\n  transport?: TransportSummary;\n  attractions?: AttractionItem[];\n};\n\ntype BudgetPanelProps = {\n  days: PlanDay[];\n};\n\nfunction avgPrice(range?: PriceRange): number {\n  if (!range || range.length !== 2) return 0;\n  const a = Number(range[0]);\n  const b = Number(range[1]);\n  if (Number.isFinite(a) && Number.isFinite(b)) return (a + b) / 2;\n  return 0;\n}\n\nfunction ticketToNumber(t?: number | string): number {\n  if (t == null) return 0;\n  if (typeof t === \"number\" && Number.isFinite(t)) return t;\n  const n = Number(t);\n  return Number.isFinite(n) ? n : 0;\n}\n\nexport default function BudgetPanel({ days }: BudgetPanelProps) {\n  const [totalBudget, setTotalBudget] = useState<number | null>(null);\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"lastPrefs\");\n      if (raw) {\n        const p = JSON.parse(raw);\n        if (typeof p?.budgetTotal === \"number\") setTotalBudget(p.budgetTotal);\n      }\n    } catch {}\n  }, []);\n\n  const { byDay, totals } = useMemo(() => {\n    const byDay: { date: string; transport: number; dining: number; lodging: number; tickets: number; total: number }[] = [];\n    let transport = 0, dining = 0, lodging = 0, tickets = 0;\n    for (const d of days || []) {\n      const t = Number(d.transport?.priceEstimate) || 0;\n      const dine = (d.dining || []).reduce((s, it) => s + avgPrice(it.priceRange), 0);\n      const lodge = (d.lodging || []).reduce((s, it) => s + (Number(it.price) || 0), 0);\n      const tick = (d.attractions || []).reduce((s, it) => s + ticketToNumber(it.ticket), 0);\n      const total = t + dine + lodge + tick;\n      byDay.push({ date: d.date, transport: t, dining: dine, lodging: lodge, tickets: tick, total });\n      transport += t; dining += dine; lodging += lodge; tickets += tick;\n    }\n    const grand = transport + dining + lodging + tickets;\n    return { byDay, totals: { transport, dining, lodging, tickets, grand } };\n  }, [days]);\n\n  const maxCategory = Math.max(1, totals.grand, totals.transport, totals.dining, totals.lodging, totals.tickets);\n\n  return (\n    <div className=\"rounded-lg border border-zinc-200 p-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"text-sm font-medium\">È¢ÑÁÆóÁÆ°ÁêÜ</div>\n        {typeof totalBudget === \"number\" ? (\n          <div className=\"text-xs text-zinc-600\">ÊÄªÈ¢ÑÁÆóÔºö<span className=\"font-semibold text-zinc-900\">¬•{Math.round(totalBudget)}</span></div>\n        ) : (\n          <div className=\"text-xs text-zinc-500\">Êú™ËÆæÁΩÆÊÄªÈ¢ÑÁÆóÔºàÂÅèÂ•Ω‰∏≠ÂèØËÆæÁΩÆÔºâ</div>\n        )}\n      </div>\n\n      <div className=\"mt-3 grid grid-cols-1 gap-3\">\n        <div>\n          <div className=\"text-xs text-zinc-600\">‰º∞ÁÆóÊÄªÊîØÂá∫</div>\n          <div className=\"mt-1 text-sm\">\n            <span className=\"font-semibold\">¬•{Math.round(totals.grand)}</span>\n            {typeof totalBudget === \"number\" && (\n              <span className=\"ml-2 text-xs text-zinc-500\">ÔºàÂâ©‰ΩôÔºö¬•{Math.round(totalBudget - totals.grand)}Ôºâ</span>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2\">\n          {[\n            { label: \"‰∫§ÈÄö\", value: totals.transport, color: \"bg-blue-500\" },\n            { label: \"È§êÈ•Æ\", value: totals.dining, color: \"bg-orange-500\" },\n            { label: \"‰ΩèÂÆø\", value: totals.lodging, color: \"bg-purple-500\" },\n            { label: \"Èó®Á•®\", value: totals.tickets, color: \"bg-emerald-500\" },\n          ].map((c) => (\n            <div key={c.label} className=\"text-xs\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-zinc-600\">{c.label}</span>\n                <span className=\"text-zinc-900\">¬•{Math.round(c.value)}</span>\n              </div>\n              <div className=\"mt-1 h-2 rounded bg-zinc-100\">\n                <div className={[\"h-2 rounded\", c.color].join(\" \")}\n                  style={{ width: `${Math.min(100, (c.value / maxCategory) * 100)}%` }}\n                />\n              </div>\n            </div>\n          ))}\n        </div>\n\n        <div className=\"mt-2\">\n          <div className=\"text-xs text-zinc-600 mb-1\">ÊåâÂ§©‰º∞ÁÆó</div>\n          <div className=\"space-y-1\">\n            {byDay.map((d) => (\n              <div key={d.date} className=\"flex items-center justify-between text-xs\">\n                <span className=\"text-zinc-600\">{d.date}</span>\n                <span className=\"text-zinc-900\">¬•{Math.round(d.total)}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 854, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/app/plan/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport MapView from \"@/components/MapView\";\nimport VoiceButton from \"@/components/VoiceButton\";\nimport Card from \"@/components/Card\";\nimport Badge from \"@/components/Badge\";\nimport Button from \"@/components/Button\";\nimport BudgetPanel from \"@/components/BudgetPanel\";\nimport type { PlanDay } from \"@/lib/itinerarySchema\";\n\nfunction useRouteQuery(params: { origin?: string; destination?: string; type?: string; originCoord?: string; destinationCoord?: string }) {\n  const { origin = \"Âåó‰∫¨Á´ô\", destination = \"Â§©ÂÆâÈó®\", type = \"driving\", originCoord = \"116.4336,39.9024\", destinationCoord = \"116.3975,39.9087\" } = params;\n  return useQuery({\n    queryKey: [\"route\", origin, destination, originCoord, destinationCoord, type],\n    queryFn: async () => {\n      const u = new URL(\"/api/map/route\", window.location.origin);\n      u.searchParams.set(\"origin\", originCoord);\n      u.searchParams.set(\"destination\", destinationCoord);\n      u.searchParams.set(\"type\", type);\n      const res = await fetch(u.toString());\n      if (res.status === 501) {\n        // ÂêéÁ´ØÊú™ÈÖçÁΩÆ AMAP_WEBSERVICE_KEY Êó∂ËøîÂõû 501ÔºåÂç†‰ΩçÂøΩÁï•ÈîôËØØ‰ª•ÈÅøÂÖçÊâìÊñ≠È°µÈù¢\n        return null;\n      }\n      if (!res.ok) {\n        const msg = await res.text().catch(() => \"route api error\");\n        throw new Error(msg || \"route api error\");\n      }\n      return res.json();\n    },\n    enabled: !!originCoord && !!destinationCoord,\n  });\n}\n\n// Â∑≤ÁßªÈô§ÊêúÁ¥¢Âú∞ÁÇπ‰∏éÂüéÂ∏ÇÁöÑÊòæÂºèUIÔºõ‰ªç‰øùÁïôÂÜÖÈÉ®Ëß£Êûê‰ª•ÊîØÊåÅËØ≠Èü≥‰∏éÊâãÂä®Êü•ËØ¢\n\nexport default function PlanPage() {\n  const [origin, setOrigin] = useState(\"Âåó‰∫¨Á´ô\");\n  const [destination, setDestination] = useState(\"Â§©ÂÆâÈó®\");\n  const [originCoord, setOriginCoord] = useState(\"116.4336,39.9024\");\n  const [destinationCoord, setDestinationCoord] = useState(\"116.3975,39.9087\");\n  const [type, setType] = useState(\"driving\");\n  const [selectedDay, setSelectedDay] = useState<number>(0);\n  const [highlightItemId, setHighlightItemId] = useState<string | null>(null);\n  const [focusMarkers, setFocusMarkers] = useState<{ position: [number, number]; title?: string }[]>([]);\n  const [filterText, setFilterText] = useState(\"\");\n  const [timeFilter, setTimeFilter] = useState<\"all\" | \"morning\" | \"afternoon\" | \"evening\">(\"all\");\n  const [showPrefs, setShowPrefs] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [genError, setGenError] = useState<string | null>(null);\n  const [destInput, setDestInput] = useState(\"\");\n  const [startInput, setStartInput] = useState(\"\");\n  const [endInput, setEndInput] = useState(\"\");\n  const [pace, setPace] = useState<\"relaxed\" | \"standard\" | \"intense\">(\"standard\");\n  const [interestsText, setInterestsText] = useState(\"\");\n  const [budgetInput, setBudgetInput] = useState<string>(\"\");\n\n  // ‰∏ªÈ°µÁîüÊàêÁöÑË°åÁ®ãÊï∞ÊçÆÔºàlocalStorage Ê≥®ÂÖ•Ôºâ\n  const [plan, setPlan] = useState<null | { destination: string; start_date: string; end_date: string; days: PlanDay[]; markers?: { position: [number, number]; title?: string }[]; source?: \"llm\" | \"fallback\" }>(null);\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"lastPlan\");\n      if (raw) {\n        const obj = JSON.parse(raw);\n        if (obj && obj.destination && obj.days) setPlan(obj);\n      }\n      const prefsRaw = localStorage.getItem(\"lastPrefs\");\n      if (prefsRaw) {\n        const pj = JSON.parse(prefsRaw);\n        if (pj?.pace) setPace(pj.pace);\n        if (Array.isArray(pj?.interests)) setInterestsText(pj.interests.join(\", \"));\n        if (typeof pj?.budgetTotal === \"number\") setBudgetInput(String(pj.budgetTotal));\n      }\n    } catch {}\n  }, []);\n\n  useEffect(() => {\n    // Ë°åÁ®ãÊõ¥Êñ∞Êó∂ÈªòËÆ§ÈÄâ‰∏≠Á¨¨ 1 Â§©Âπ∂Ê∏ÖÁ©∫È´ò‰∫Æ\n    setSelectedDay(0);\n    setHighlightItemId(null);\n    setFocusMarkers([]);\n  }, [plan?.destination, plan?.start_date, plan?.end_date, plan?.days?.length]);\n\n  useEffect(() => {\n    if (showPrefs && plan) {\n      setDestInput(plan.destination || \"\");\n      setStartInput(plan.start_date || \"\");\n      setEndInput(plan.end_date || \"\");\n    }\n  }, [showPrefs]);\n\n  const { data, isLoading, error, refetch } = useRouteQuery({ origin, destination, originCoord, destinationCoord, type });\n\n  const routePath = data?.polyline ?? [];\n  const planMarkers = useMemo(() => plan?.markers ?? [], [plan]);\n  const markersToRender = focusMarkers.length ? focusMarkers : planMarkers;\n  const center = focusMarkers.length\n    ? focusMarkers[0].position\n    : routePath.length\n    ? routePath[0]\n    : planMarkers.length\n    ? planMarkers[0].position\n    : [116.397428, 39.90923];\n\n  // Ëß£Êûê‚Äú‰ªéxxxÂà∞xxx‚ÄùÂπ∂ÁîüÊàêË∑ØÁ∫ø\n  const handleTranscribe = async (text: string) => {\n    // Ê∏ÖÁêÜÊç¢Ë°å/Â§ö‰ΩôÁ©∫Ê†º/Âè•Êú´Ê†áÁÇπÔºåÂπ∂Ëß£Êûê‚Äú‰ªéxxxÂà∞xxx‚Äù\n    const cleaned = String(text)\n      .replace(/[\\n\\r]+/g, \" \")\n      .replace(/\\s+/g, \" \")\n      .replace(/[Ôºå,„ÄÇ.!ÔºÅ?Ôºü]+$/g, \"\")\n      .trim();\n    const m = cleaned.match(/‰ªé\\s*(.+?)\\s*Âà∞\\s*(.+)$/);\n    if (!m) {\n      // ‰∏çÂåπÈÖçÂàôÂøΩÁï•\n      return;\n    }\n    const fromName = m[1].trim();\n    const toName = m[2].trim();\n\n    const extractCity = (n: string) => {\n      const cities = [\n        \"Âåó‰∫¨\",\"Â§©Ê¥•\",\"‰∏äÊµ∑\",\"ÈáçÂ∫Ü\",\"ÂπøÂ∑û\",\"Ê∑±Âú≥\",\"Êù≠Â∑û\",\"ËãèÂ∑û\",\"Âçó‰∫¨\",\"Ê≠¶Ê±â\",\"ÊàêÈÉΩ\",\"Ë•øÂÆâ\",\"ÈùíÂ≤õ\",\"Â§ßËøû\",\"Ê≤àÈò≥\",\"ÈïøÊò•\",\"ÂìàÂ∞îÊª®\",\"ÊµéÂçó\",\"ÈÉëÂ∑û\",\"‰ΩõÂ±±\",\"ÂÆÅÊ≥¢\",\"Êó†Èî°\",\"Âé¶Èó®\",\"Á¶èÂ∑û\",\"ÂêàËÇ•\",\"ÈïøÊ≤ô\",\"ÂçóÊòå\",\"ÊòÜÊòé\",\"Áü≥ÂÆ∂Â∫Ñ\",\"Â§™Âéü\",\"ÂÖ∞Â∑û\",\"ÂëºÂíåÊµ©Áâπ\",\"Ë¥µÈò≥\",\"ÂçóÂÆÅ\",\"Êµ∑Âè£\",\"ÂîêÂ±±\",\"‰øùÂÆö\"\n      ];\n      for (const c of cities) {\n        if (n.includes(c)) return c;\n      }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)Â∏Ç/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name);\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const norm = (s: string) => s.replace(/\\s+/g, \"\").toLowerCase();\n      const target = norm(name);\n      const exact = pois.find((p: any) => norm(p.name) === target);\n      if (exact) return { name, coord: `${exact.location.lng},${exact.location.lat}` };\n      const byCity = city ? pois.find((p: any) => (p.cityname?.includes(city) || p.adname?.includes(city)) && norm(p.name).includes(target)) : null;\n      const poi = byCity || pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}` };\n    };\n\n    // ÂÖàÊääÂ∑¶‰æßËæìÂÖ•ÂêåÊ≠•‰∏∫ËØ≠Èü≥ÊñáÊú¨\n    setOrigin(fromName);\n    setDestination(toName);\n    const from = await resolvePoi(fromName);\n    const to = await resolvePoi(toName);\n\n    if (from) setOriginCoord(from.coord);\n    if (to) setDestinationCoord(to.coord);\n\n    // Ëß¶ÂèëË∑ØÁ∫øÊü•ËØ¢\n    refetch();\n  };\n\n  // Ê†πÊçÆÁªèÁ∫¨Â∫¶Âú®Âú∞Âõæ‰∏äÂÆö‰ΩçÂπ∂È´ò‰∫Æ\n  const handleLocatePoint = (lat: number, lng: number, title?: string) => {\n    if (!Number.isFinite(lat) || !Number.isFinite(lng)) return;\n    setFocusMarkers([{ position: [lng, lat], title }]);\n    // Ê∏ÖÈô§Ë∑ØÁ∫ø‰ª•Á™ÅÂá∫Ê†áËÆ∞\n    setOriginCoord(\"\");\n    setDestinationCoord(\"\");\n  };\n\n  // Ê†πÊçÆÂêçÁß∞Ëß£ÊûêÂùêÊ†áÂπ∂ÂÆö‰ΩçÔºà‰ºòÂÖà‰ΩøÁî®ËÆ°ÂàíÁõÆÁöÑÂú∞‰Ωú‰∏∫ÂüéÂ∏ÇËåÉÂõ¥Ôºâ\n  const locateByPlaceName = async (name: string) => {\n    const extractCity = (n: string) => {\n      const cities = [\n        \"Âåó‰∫¨\",\"Â§©Ê¥•\",\"‰∏äÊµ∑\",\"ÈáçÂ∫Ü\",\"ÂπøÂ∑û\",\"Ê∑±Âú≥\",\"Êù≠Â∑û\",\"ËãèÂ∑û\",\"Âçó‰∫¨\",\"Ê≠¶Ê±â\",\"ÊàêÈÉΩ\",\"Ë•øÂÆâ\",\"ÈùíÂ≤õ\",\"Â§ßËøû\",\"Ê≤àÈò≥\",\"ÈïøÊò•\",\"ÂìàÂ∞îÊª®\",\"ÊµéÂçó\",\"ÈÉëÂ∑û\",\"‰ΩõÂ±±\",\"ÂÆÅÊ≥¢\",\"Êó†Èî°\",\"Âé¶Èó®\",\"Á¶èÂ∑û\",\"ÂêàËÇ•\",\"ÈïøÊ≤ô\",\"ÂçóÊòå\",\"ÊòÜÊòé\",\"Áü≥ÂÆ∂Â∫Ñ\",\"Â§™Âéü\",\"ÂÖ∞Â∑û\",\"ÂëºÂíåÊµ©Áâπ\",\"Ë¥µÈò≥\",\"ÂçóÂÆÅ\",\"Êµ∑Âè£\",\"ÂîêÂ±±\",\"‰øùÂÆö\"\n      ];\n      for (const c of cities) { if ((plan?.destination || \"\").includes(c) || n.includes(c)) return c; }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)Â∏Ç/);\n      if (m) return m[1];\n      return (plan?.destination || \"\");\n    };\n    const city = extractCity(name || plan?.destination || \"\");\n    const u = new URL(\"/api/map/search\", window.location.origin);\n    u.searchParams.set(\"query\", name);\n    if (city) u.searchParams.set(\"city\", city);\n    const resp = await fetch(u.toString());\n    if (!resp.ok) return;\n    const jd = await resp.json().catch(() => null);\n    const pois: any[] = jd?.pois || [];\n    if (!pois.length) return;\n    const poi = pois[0];\n    const lng = Number(poi.location?.lng);\n    const lat = Number(poi.location?.lat);\n    if (Number.isFinite(lat) && Number.isFinite(lng)) {\n      handleLocatePoint(lat, lng, name);\n    }\n  };\n\n  // ÊâãÂä®Êü•ËØ¢ÊåâÈíÆÔºöËã•ÂùêÊ†áÊú™‰∏éÂêçÁß∞ÂåπÈÖçÔºåÂàôËá™Âä®Ëß£ÊûêÂùêÊ†á\n  const handleQueryRoute = async () => {\n    const extractCity = (n: string) => {\n      const cities = [\n        \"Âåó‰∫¨\",\"Â§©Ê¥•\",\"‰∏äÊµ∑\",\"ÈáçÂ∫Ü\",\"ÂπøÂ∑û\",\"Ê∑±Âú≥\",\"Êù≠Â∑û\",\"ËãèÂ∑û\",\"Âçó‰∫¨\",\"Ê≠¶Ê±â\",\"ÊàêÈÉΩ\",\"Ë•øÂÆâ\",\"ÈùíÂ≤õ\",\"Â§ßËøû\",\"Ê≤àÈò≥\",\"ÈïøÊò•\",\"ÂìàÂ∞îÊª®\",\"ÊµéÂçó\",\"ÈÉëÂ∑û\",\"‰ΩõÂ±±\",\"ÂÆÅÊ≥¢\",\"Êó†Èî°\",\"Âé¶Èó®\",\"Á¶èÂ∑û\",\"ÂêàËÇ•\",\"ÈïøÊ≤ô\",\"ÂçóÊòå\",\"ÊòÜÊòé\",\"Áü≥ÂÆ∂Â∫Ñ\",\"Â§™Âéü\",\"ÂÖ∞Â∑û\",\"ÂëºÂíåÊµ©Áâπ\",\"Ë¥µÈò≥\",\"ÂçóÂÆÅ\",\"Êµ∑Âè£\",\"ÂîêÂ±±\",\"‰øùÂÆö\"\n      ];\n      for (const c of cities) {\n        if (n.includes(c)) return c;\n      }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)Â∏Ç/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name);\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const norm = (s: string) => s.replace(/\\s+/g, \"\").toLowerCase();\n      const target = norm(name);\n      const exact = pois.find((p: any) => norm(p.name) === target);\n      if (exact) return { name, coord: `${exact.location.lng},${exact.location.lat}` };\n      const byCity = city ? pois.find((p: any) => (p.cityname?.includes(city) || p.adname?.includes(city)) && norm(p.name).includes(target)) : null;\n      const poi = byCity || pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}` };\n    };\n\n    // Ëã•ÂùêÊ†á‰ªçÊòØÈªòËÆ§ÊàñÊú™Êõ¥Êñ∞ÔºåÂàôÂ∞ùËØïÁî®ÂêçÁß∞Ëß£Êûê\n    if (!originCoord || originCoord === \"116.4336,39.9024\") {\n      const from = await resolvePoi(origin);\n      if (from) { setOrigin(from.name); setOriginCoord(from.coord); }\n    }\n    if (!destinationCoord || destinationCoord === \"116.3975,39.9087\") {\n      const to = await resolvePoi(destination);\n      if (to) { setDestination(to.name); setDestinationCoord(to.coord); }\n    }\n\n    refetch();\n  };\n\n  // ÁÇπÂáªÊó∂Èó¥Á∫øÊù°ÁõÆÔºöËß£ÊûêÂâçÂêé‰∏§ÁÇπÂπ∂Âú®Âú∞Âõæ‰∏äÁªòÂà∂ÂΩìÂ§©Â±ÄÈÉ®Ë∑ØÁ∫ø\n  const handleItemClick = async (dayIndex: number, itemIndex: number) => {\n    if (!plan || !plan.days[dayIndex]) return;\n    setSelectedDay(dayIndex);\n    const day = plan.days[dayIndex];\n    const cur = day.items[itemIndex];\n    setHighlightItemId(cur.id ?? null);\n\n    const extractCity = (n: string) => {\n      const cities = [\n        \"Âåó‰∫¨\",\"Â§©Ê¥•\",\"‰∏äÊµ∑\",\"ÈáçÂ∫Ü\",\"ÂπøÂ∑û\",\"Ê∑±Âú≥\",\"Êù≠Â∑û\",\"ËãèÂ∑û\",\"Âçó‰∫¨\",\"Ê≠¶Ê±â\",\"ÊàêÈÉΩ\",\"Ë•øÂÆâ\",\"ÈùíÂ≤õ\",\"Â§ßËøû\",\"Ê≤àÈò≥\",\"ÈïøÊò•\",\"ÂìàÂ∞îÊª®\",\"ÊµéÂçó\",\"ÈÉëÂ∑û\",\"‰ΩõÂ±±\",\"ÂÆÅÊ≥¢\",\"Êó†Èî°\",\"Âé¶Èó®\",\"Á¶èÂ∑û\",\"ÂêàËÇ•\",\"ÈïøÊ≤ô\",\"ÂçóÊòå\",\"ÊòÜÊòé\",\"Áü≥ÂÆ∂Â∫Ñ\",\"Â§™Âéü\",\"ÂÖ∞Â∑û\",\"ÂëºÂíåÊµ©Áâπ\",\"Ë¥µÈò≥\",\"ÂçóÂÆÅ\",\"Êµ∑Âè£\",\"ÂîêÂ±±\",\"‰øùÂÆö\"\n      ];\n      for (const c of cities) { if ((plan?.destination || \"\").includes(c) || n.includes(c)) return c; }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)Â∏Ç/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name || plan?.destination || \"\");\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const poi = pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}`, pos: [poi.location.lng, poi.location.lat] as [number, number] };\n    };\n\n    // Ââç‰∏Ä‰∏™ÁÇπÔºàËã•‰∏çÂ≠òÂú®Âàô‰ΩøÁî®ÂΩìÂ§©Á¨¨‰∏Ä‰∏™ÊàñÈªòËÆ§Ëµ∑ÁÇπÂêçÔºâ\n    const prev = day.items[itemIndex - 1];\n    const fromName = (prev as any)?.place?.name || prev?.title || (day.items[0] as any)?.place?.name || day.items[0]?.title || origin;\n    const toName = (cur as any)?.place?.name || cur.title;\n    const from = await resolvePoi(fromName);\n    const to = await resolvePoi(toName);\n    if (!to) return;\n\n    if (from) {\n      setOrigin(from.name);\n      setOriginCoord(from.coord);\n    }\n    setDestination(to.name);\n    setDestinationCoord(to.coord);\n    setType(\"walking\");\n    setFocusMarkers([\n      from?.pos ? { position: from.pos, title: from.name } : undefined,\n      to.pos ? { position: to.pos, title: to.name } : undefined,\n    ].filter(Boolean) as { position: [number, number]; title?: string }[]);\n    refetch();\n  };\n\n  return (\n    <div className=\"p-4 space-y-4\">\n      {plan && (\n        <Card title=\"ÊúÄÊñ∞ÁîüÊàêË°åÁ®ã\" actions={<Button size=\"sm\" variant=\"secondary\" onClick={() => setShowPrefs(true)}>ÂÅèÂ•Ω‰∏éÈáçÊñ∞ÁîüÊàê</Button>}>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-sm font-medium flex items-center gap-2\">\n              <span>{plan.destination}</span>\n              {plan.source === \"fallback\" ? (\n                <Badge variant=\"warning\" className=\"ml-1\">‰ΩøÁî®ÂÖúÂ∫ïÊï∞ÊçÆ</Badge>\n              ) : null}\n            </div>\n            <Badge variant=\"gray\">{plan.start_date} ‚Üí {plan.end_date}</Badge>\n          </div>\n          {/* Â∑≤ÁßªÈô§È°∂ÈÉ®Á≠õÈÄâÊéß‰ª∂‰ª•‰øùÊåÅÂ§¥ÈÉ®ÁÆÄÊ¥Å */}\n          <div className=\"mt-3 grid grid-cols-1 gap-3 lg:grid-cols-2\">\n            {/* Â∑¶‰æßÔºöÊó•Á®ãÂØºËà™ÔºàÁ¥ßÂáëÊëòË¶ÅÔºâ + Â∑¶‰∏ãÈ¢ÑÁÆóÁÆ°ÁêÜ */}\n            <div className=\"flex flex-col gap-2\">\n              {plan.days.map((d, di) => {\n                const diningCount = Array.isArray(d.dining) ? d.dining.length : 0;\n                const lodgingCount = Array.isArray(d.lodging) ? d.lodging.length : 0;\n                const attractionCount = Array.isArray(d.attractions) ? d.attractions.length : 0;\n                const transportShort = d.transport ? `${d.transport.mode || \"-\"} ¬∑ ${typeof d.transport.timeEstimate === \"number\" ? `${Math.round(d.transport.timeEstimate)}m` : \"--\"} ¬∑ ${typeof d.transport.priceEstimate === \"number\" ? `Ôø•${Math.round(d.transport.priceEstimate)}` : \"--\"}` : \"Êó†‰∫§ÈÄö‰ø°ÊÅØ\";\n                const previewItems = (d.items || [])\n                  .slice(0, 2)\n                  .map((it: any) => `${it.time ? it.time + \" \" : \"\"}${(it?.place?.name) || it.title}`)\n                  .join(\" ¬∑ \");\n                return (\n                  <button key={d.date} className={[\"w-full mb-2 rounded border p-2 text-left\", di === selectedDay ? \"border-blue-500 bg-blue-50\" : \"border-zinc-200 hover:bg-zinc-50\"].join(\" \")}\n                    onClick={() => setSelectedDay(di)}>\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-xs font-medium\">{d.date}</div>\n                      <div className=\"flex items-center gap-2 text-[11px] text-zinc-600\">\n                        <span>üçΩÔ∏è{diningCount}</span>\n                        <span>üè®{lodgingCount}</span>\n                        <span>üìç{attractionCount}</span>\n                      </div>\n                    </div>\n                    <div className=\"mt-1 text-[11px] text-zinc-600 truncate\">{previewItems || \"Êó†Ê¥ªÂä®È¢ÑËßà\"}</div>\n                    <div className=\"mt-1 text-[11px] text-zinc-600\">{transportShort}</div>\n                  </button>\n                );\n              })}\n              {/* Á¥ßÂáëÈ¢ÑÁÆóÁÆ°ÁêÜÔºöÈªòËÆ§Â±ïÂºÄÔºåÊîæÁΩÆ‰∫éÂ∑¶‰æßÂ∫ïÈÉ®Á©∫ÁôΩÂå∫Âüü */}\n              <div className=\"mt-2 rounded border border-zinc-200 bg-white/70 p-2 text-[12px] text-zinc-700\">\n                <div className=\"mb-1 flex items-center justify-between\">\n                  <div className=\"font-medium text-zinc-800\">È¢ÑÁÆóÁÆ°ÁêÜ</div>\n                </div>\n                <div className=\"max-h-[260px] overflow-y-auto\">\n                  <BudgetPanel days={plan.days as any} />\n                </div>\n              </div>\n            </div>\n            {/* Âè≥‰æßÔºöÈÄâ‰∏≠ÂΩìÂ§©ÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºàÊäòÂè†ÈõÜ‰∏≠ÊòæÁ§∫Ôºâ */}\n            <div className=\"space-y-3\">\n              <Card title={`${plan.days[selectedDay]?.date || \"\"} ËØ¶ÁªÜ`}>\n                {(() => {\n                  const d = plan.days[selectedDay];\n                  if (!d) return <div className=\"text-xs text-zinc-500\">Êó†ÂΩìÂ§©Êï∞ÊçÆ</div>;\n                  const matchText = (it: any) => {\n                    const q = filterText.trim().toLowerCase();\n                    if (!q) return true;\n                    return (\n                      String((it?.place?.name || it.title || \"\")).toLowerCase().includes(q) ||\n                      String(it.note || \"\").toLowerCase().includes(q)\n                    );\n                  };\n                  const matchTime = (it: any) => {\n                    if (timeFilter === \"all\") return true;\n                    const m = String(it.time || \"\").match(/^(\\d{1,2}):(\\d{2})/);\n                    if (!m) return true;\n                    const h = Number(m[1]);\n                    if (timeFilter === \"morning\") return h < 12;\n                    if (timeFilter === \"afternoon\") return h >= 12 && h < 17;\n                    if (timeFilter === \"evening\") return h >= 17;\n                    return true;\n                  };\n                  const items = d.items.filter((it) => matchText(it) && matchTime(it));\n                  return (\n                    <div>\n                      <ul className=\"space-y-1\">\n                        {items.map((it: any, ii) => (\n                          <li key={it.id || `${d.date}-${ii}`} className={[\"cursor-pointer rounded px-1 py-0.5 text-xs\", highlightItemId === it.id ? \"bg-blue-100 text-blue-700\" : \"text-zinc-700 hover:bg-zinc-100\"].join(\" \")}\n                              onClick={() => handleItemClick(selectedDay, ii)}>\n                            {it.time ? <span className=\"mr-2 text-zinc-500\">{it.time}</span> : null}\n                            {it?.place?.name || it.title}\n                            {it.note ? <span className=\"ml-2 text-zinc-400\">{it.note}</span> : null}\n                          </li>\n                        ))}\n                        {items.length === 0 && (\n                          <li className=\"text-[12px] text-zinc-500\">ËØ•Á≠õÈÄâ‰∏ãÊöÇÊó†Ê¥ªÂä®</li>\n                        )}\n                      </ul>\n                      {/* ‰∫§ÈÄö‰ø°ÊÅØ */}\n                      {d.transport && (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">‰∫§ÈÄö</div>\n                          <div className=\"mt-1\">ÊñπÂºèÔºö{String(d.transport.mode || \"\").trim() || \"-\"}</div>\n                          {Array.isArray(d.transport.steps) && d.transport.steps.length ? (\n                            <div className=\"mt-1\">Ê≠•È™§Ôºö{d.transport.steps.join(\"Ôºå\")}</div>\n                          ) : null}\n                          <div className=\"mt-1\">ËÄóÊó∂Ôºö{typeof d.transport.timeEstimate === \"number\" ? `${Math.round(d.transport.timeEstimate)} ÂàÜÈíü` : \"-\"}</div>\n                          <div className=\"mt-1\">Ë¥πÁî®Ôºö{typeof d.transport.priceEstimate === \"number\" ? `${Math.round(d.transport.priceEstimate)} ÂÖÉ` : \"-\"}</div>\n                        </div>\n                      )}\n                      {/* È§êÈ•ÆÂàóË°® */}\n                      {Array.isArray(d.dining) && d.dining.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">È§êÈ•Æ</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.dining.map((r: any, idx: number) => (\n                              <li\n                                key={`${d.date}-dining-${idx}`}\n                                className=\"flex items-center justify-between cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (r.location && typeof r.location.lat === \"number\" && typeof r.location.lng === \"number\") {\n                                    handleLocatePoint(r.location.lat, r.location.lng, r.name);\n                                  } else {\n                                    locateByPlaceName(r.name);\n                                  }\n                                }}\n                              >\n                                <div>\n                                  <span className=\"text-zinc-800\">{r.name}</span>\n                                  {r.cuisine ? <span className=\"ml-2 text-zinc-500\">{r.cuisine}</span> : null}\n                                  {Array.isArray(r.priceRange) && r.priceRange.length === 2 ? (\n                                    <span className=\"ml-2 text-zinc-600\">Ôø•{r.priceRange[0]}‚Äì{r.priceRange[1]}</span>\n                                  ) : null}\n                                  {typeof r.rating === \"number\" ? (\n                                    <span className=\"ml-2 text-amber-600\">ËØÑÂàÜ {r.rating}</span>\n                                  ) : null}\n                                </div>\n                                {r.location && typeof r.location.lat === \"number\" && typeof r.location.lng === \"number\" ? (\n                                  <button className=\"rounded bg-blue-500 px-2 py-0.5 text-white\" onClick={(e) => { e.stopPropagation(); handleLocatePoint(r.location.lat, r.location.lng, r.name); }}>ÂÆö‰Ωç</button>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                      {/* ‰ΩèÂÆøÂàóË°® */}\n                      {Array.isArray(d.lodging) && d.lodging.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">‰ΩèÂÆø</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.lodging.map((h: any, idx: number) => (\n                              <li\n                                key={`${d.date}-lodging-${idx}`}\n                                className=\"flex items-center justify-between cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (h.location && typeof h.location.lat === \"number\" && typeof h.location.lng === \"number\") {\n                                    handleLocatePoint(h.location.lat, h.location.lng, h.name);\n                                  } else {\n                                    locateByPlaceName(h.name);\n                                  }\n                                }}\n                              >\n                                <div>\n                                  <span className=\"text-zinc-800\">{h.name}</span>\n                                  {h.area ? <span className=\"ml-2 text-zinc-500\">{h.area}</span> : null}\n                                  {typeof h.price === \"number\" ? <span className=\"ml-2 text-zinc-600\">Ôø•{h.price}</span> : null}\n                                  {typeof h.rating === \"number\" ? <span className=\"ml-2 text-amber-600\">ËØÑÂàÜ {h.rating}</span> : null}\n                                  {Array.isArray(h.amenities) && h.amenities.length ? (\n                                    <span className=\"ml-2 text-zinc-500\">{h.amenities.join(\"„ÄÅ\")}</span>\n                                  ) : null}\n                                </div>\n                                {h.location && typeof h.location.lat === \"number\" && typeof h.location.lng === \"number\" ? (\n                                  <button className=\"rounded bg-blue-500 px-2 py-0.5 text-white\" onClick={(e) => { e.stopPropagation(); handleLocatePoint(h.location.lat, h.location.lng, h.name); }}>ÂÆö‰Ωç</button>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                      {/* ÊôØÁÇπÂàóË°® */}\n                      {Array.isArray(d.attractions) && d.attractions.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">ÊôØÁÇπ</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.attractions.map((a: any, idx: number) => (\n                              <li\n                                key={`${d.date}-attraction-${idx}`}\n                                className=\"cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (a.location && typeof a.location.lat === \"number\" && typeof a.location.lng === \"number\") {\n                                    handleLocatePoint(a.location.lat, a.location.lng, a.name);\n                                  } else {\n                                    locateByPlaceName(a.name);\n                                  }\n                                }}\n                              >\n                                <span className=\"text-zinc-800\">{a.name}</span>\n                                {typeof a.ticket === \"number\" ? <span className=\"ml-2 text-zinc-600\">Èó®Á•® Ôø•{a.ticket}</span> : a.ticket ? <span className=\"ml-2 text-zinc-600\">Èó®Á•® {String(a.ticket)}</span> : null}\n                                {a.best_time ? <span className=\"ml-2 text-zinc-500\">ÊúÄ‰Ω≥Êó∂ÊÆµ {a.best_time}</span> : null}\n                                {a.tips ? <span className=\"ml-2 text-zinc-500\">{a.tips}</span> : null}\n                                {Array.isArray(a.photo_spots) && a.photo_spots.length ? (\n                                  <div className=\"mt-0.5 text-zinc-600\">ÊãçÁÖßÁÇπÔºö{a.photo_spots.join(\"„ÄÅ\")}</div>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                    </div>\n                  );\n                })()}\n              </Card>\n            </div>\n          </div>\n        </Card>\n      )}\n      <div className=\"flex gap-2\">\n        <input className=\"border px-2 py-1\" placeholder=\"Ëµ∑ÁÇπ\" value={origin} onChange={(e) => setOrigin(e.target.value)} />\n        <input className=\"border px-2 py-1\" placeholder=\"ÁªàÁÇπ\" value={destination} onChange={(e) => setDestination(e.target.value)} />\n        <select className=\"border px-2 py-1\" value={type} onChange={(e) => setType(e.target.value)}>\n          <option value=\"driving\">È©æËΩ¶</option>\n          <option value=\"walking\">Ê≠•Ë°å</option>\n          <option value=\"bicycling\">È™ëË°å</option>\n        </select>\n        <button className=\"bg-blue-600 text-white px-3 py-1 rounded\" onClick={handleQueryRoute}>Êü•ËØ¢Ë∑ØÁ∫ø</button>\n        <VoiceButton onTranscribe={handleTranscribe} />\n      </div>\n      {error && <div className=\"text-red-600\">{String((error as Error)?.message)}</div>}\n      {isLoading && <div>Âä†ËΩΩ‰∏≠...</div>}\n      <Card title=\"Âú∞Âõæ‰∏éË∑ØÁ∫ø\">\n        <div className=\"relative h-[480px]\">\n          <MapView center={center as [number, number]} zoom={12} routePath={routePath} markers={markersToRender} />\n        </div>\n        {data && (\n          <div className=\"mt-3 text-sm text-gray-700\">\n            <div>Ë∑ùÁ¶ªÔºö{Math.round(data.distance)} Á±≥</div>\n            <div>È¢ÑËÆ°ËÄóÊó∂Ôºö{Math.round(data.duration / 60)} ÂàÜÈíü</div>\n          </div>\n        )}\n      </Card>\n      {showPrefs && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30\">\n          <div className=\"w-full max-w-2xl rounded-md border border-zinc-200 bg-white p-4 shadow-lg\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-sm font-medium\">ÂÅèÂ•ΩËÆæÁΩÆ‰∏éÈáçÊñ∞ÁîüÊàê</div>\n              <button className=\"text-zinc-500 hover:text-zinc-700\" onClick={() => setShowPrefs(false)}>ÂÖ≥Èó≠</button>\n            </div>\n            <div className=\"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2\">\n              <input className=\"border px-2 py-1 rounded\" placeholder=\"ÁõÆÁöÑÂú∞\" value={destInput} onChange={(e) => setDestInput(e.target.value)} />\n              <div className=\"grid grid-cols-2 gap-2\">\n                <input className=\"border px-2 py-1 rounded\" type=\"date\" value={startInput} onChange={(e) => setStartInput(e.target.value)} />\n                <input className=\"border px-2 py-1 rounded\" type=\"date\" value={endInput} onChange={(e) => setEndInput(e.target.value)} />\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <div className=\"text-xs text-zinc-600 mb-1\">Ë°åÁ®ãËäÇÂ•è</div>\n                <div className=\"flex gap-2\">\n                  {([\"relaxed\",\"standard\",\"intense\"] as const).map((p) => (\n                    <button key={p} onClick={() => setPace(p)} className={[\"rounded border px-2 py-1 text-xs\", pace===p?\"border-blue-500 bg-blue-50 text-blue-700\":\"border-zinc-300\"].join(\" \")}>{p===\"relaxed\"?\"ÊÇ†Èó≤\":p===\"standard\"?\"Ê†áÂáÜ\":\"Á¥ßÂáë\"}</button>\n                  ))}\n                </div>\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <input className=\"border px-2 py-1 rounded w-full\" placeholder=\"ÂÖ¥Ë∂£ÂÅèÂ•ΩÔºàÈÄóÂè∑ÂàÜÈöîÔºåÂ¶ÇÔºöÁæéÈ£ü, ÂçöÁâ©È¶Ü, ÂæíÊ≠•Ôºâ\" value={interestsText} onChange={(e) => setInterestsText(e.target.value)} />\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <input className=\"border px-2 py-1 rounded w-full\" type=\"number\" min=\"0\" placeholder=\"ÊÄªÈ¢ÑÁÆóÔºàÂÖÉÔºâ\" value={budgetInput} onChange={(e) => setBudgetInput(e.target.value)} />\n              </div>\n            </div>\n            {genError && <div className=\"mt-2 rounded border border-red-200 bg-red-50 p-2 text-xs text-red-700\">{genError}</div>}\n            <div className=\"mt-3 flex justify-end gap-2\">\n              <button className=\"border px-3 py-1 rounded\" onClick={() => setShowPrefs(false)}>ÂèñÊ∂à</button>\n              <button className=\"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50\" onClick={async () => {\n                setGenerating(true);\n                setGenError(null);\n                try {\n                  const interests = interestsText.split(/[,Ôºå\\s]+/).map((s) => s.trim()).filter(Boolean);\n                  const body = {\n                    destination: destInput || destination,\n                    start_date: startInput || plan?.start_date || \"\",\n                    end_date: endInput || plan?.end_date || \"\",\n                    preferences: { pace, ...(interests.length ? { interests } : {}), ...(budgetInput.trim() ? { budgetTotal: Number(budgetInput) } : {}) },\n                  };\n                  const res = await fetch(\"/api/plan/create\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(body) });\n                  if (!res.ok) { const msg = await res.text().catch(() => \"ÁîüÊàêÂ§±Ë¥•\"); throw new Error(msg || \"ÁîüÊàêÂ§±Ë¥•\"); }\n                  const data = await res.json();\n                  setPlan(data);\n                  try { localStorage.setItem(\"lastPlan\", JSON.stringify(data)); localStorage.setItem(\"lastPrefs\", JSON.stringify({ pace, interests, ...(budgetInput.trim() ? { budgetTotal: Number(budgetInput) } : {}) })); } catch {}\n                  setShowPrefs(false);\n                } catch (e: any) {\n                  setGenError(e?.message || \"ÁîüÊàêÂ§±Ë¥•\");\n                } finally {\n                  setGenerating(false);\n                }\n              }} disabled={generating}>{generating?\"ÁîüÊàê‰∏≠...\":\"ÈáçÊñ∞ÁîüÊàê\"}</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}