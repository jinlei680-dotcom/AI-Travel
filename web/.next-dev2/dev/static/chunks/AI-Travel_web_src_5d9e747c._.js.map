{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/MapView.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\ntype Marker = { position: [number, number]; title?: string };\n\ntype MapViewProps = {\n  center?: [number, number];\n  zoom?: number;\n  markers?: Marker[];\n  routePath?: [number, number][]; // 折线路径（lng,lat）数组\n  className?: string;\n};\n\nexport default function MapView({ center = [116.397428, 39.90923], zoom = 12, markers = [], routePath, className = \"\" }: MapViewProps) {\n  const ref = useRef<HTMLDivElement | null>(null);\n  const [ready, setReady] = useState(false);\n  const mapRef = useRef<any>(null);\n\n  // Lazy init: wait for AMap to be available even if script loads after render\n  useEffect(() => {\n    let timer: any;\n    const tryInit = () => {\n      const amap = (window as any).AMap;\n      if (!amap || !ref.current) {\n        setReady(false);\n        return;\n      }\n      if (!mapRef.current) {\n        setReady(true);\n        mapRef.current = new amap.Map(ref.current, {\n          zoom,\n          center,\n          viewMode: \"2D\",\n        });\n      }\n      // update overlays\n      try { mapRef.current.clearMap(); } catch {}\n      markers.forEach((m) => {\n        const marker = new amap.Marker({ position: m.position, title: m.title });\n        mapRef.current.add(marker);\n      });\n      if (routePath && routePath.length >= 2) {\n        const polyline = new amap.Polyline({\n          path: routePath,\n          strokeColor: \"#2563eb\",\n          strokeWeight: 5,\n          strokeOpacity: 0.9,\n        });\n        mapRef.current.add(polyline);\n        try { mapRef.current.setFitView([polyline]); } catch {}\n      } else {\n        try { mapRef.current.setZoomAndCenter(zoom, center); } catch {}\n      }\n    };\n    // attempt immediately and then poll briefly if not ready\n    tryInit();\n    if (!mapRef.current) {\n      timer = setInterval(() => {\n        tryInit();\n        if (mapRef.current) clearInterval(timer);\n      }, 200);\n    }\n    return () => {\n      if (timer) clearInterval(timer);\n      try { mapRef.current?.destroy?.(); } catch {}\n      mapRef.current = null;\n    };\n  }, [center, zoom, markers, routePath]);\n\n  return (\n    <div className={[\"relative overflow-hidden rounded-xl border border-gray-200\", className].join(\" \")}\n      style={{ height: \"100%\", width: \"100%\" }}\n    >\n      {!ready && (\n        <div className=\"absolute inset-0 flex items-center justify-center text-sm text-gray-500\">\n          地图未加载，请配置 `NEXT_PUBLIC_AMAP_KEY`\n        </div>\n      )}\n      <div ref={ref} className=\"w-full h-full\" />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AACA;;;AADA;;AAae,SAAS,QAAQ,EAAE,SAAS;IAAC;IAAY;CAAS,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,EAAE,SAAS,EAAE,YAAY,EAAE,EAAgB;;IACnI,MAAM,MAAM,IAAA,8LAAM,EAAwB;IAC1C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gMAAQ,EAAC;IACnC,MAAM,SAAS,IAAA,8LAAM,EAAM;IAE3B,6EAA6E;IAC7E,IAAA,iMAAS;6BAAC;YACR,IAAI;YACJ,MAAM;6CAAU;oBACd,MAAM,OAAO,AAAC,OAAe,IAAI;oBACjC,IAAI,CAAC,QAAQ,CAAC,IAAI,OAAO,EAAE;wBACzB,SAAS;wBACT;oBACF;oBACA,IAAI,CAAC,OAAO,OAAO,EAAE;wBACnB,SAAS;wBACT,OAAO,OAAO,GAAG,IAAI,KAAK,GAAG,CAAC,IAAI,OAAO,EAAE;4BACzC;4BACA;4BACA,UAAU;wBACZ;oBACF;oBACA,kBAAkB;oBAClB,IAAI;wBAAE,OAAO,OAAO,CAAC,QAAQ;oBAAI,EAAE,OAAM,CAAC;oBAC1C,QAAQ,OAAO;qDAAC,CAAC;4BACf,MAAM,SAAS,IAAI,KAAK,MAAM,CAAC;gCAAE,UAAU,EAAE,QAAQ;gCAAE,OAAO,EAAE,KAAK;4BAAC;4BACtE,OAAO,OAAO,CAAC,GAAG,CAAC;wBACrB;;oBACA,IAAI,aAAa,UAAU,MAAM,IAAI,GAAG;wBACtC,MAAM,WAAW,IAAI,KAAK,QAAQ,CAAC;4BACjC,MAAM;4BACN,aAAa;4BACb,cAAc;4BACd,eAAe;wBACjB;wBACA,OAAO,OAAO,CAAC,GAAG,CAAC;wBACnB,IAAI;4BAAE,OAAO,OAAO,CAAC,UAAU,CAAC;gCAAC;6BAAS;wBAAG,EAAE,OAAM,CAAC;oBACxD,OAAO;wBACL,IAAI;4BAAE,OAAO,OAAO,CAAC,gBAAgB,CAAC,MAAM;wBAAS,EAAE,OAAM,CAAC;oBAChE;gBACF;;YACA,yDAAyD;YACzD;YACA,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,QAAQ;yCAAY;wBAClB;wBACA,IAAI,OAAO,OAAO,EAAE,cAAc;oBACpC;wCAAG;YACL;YACA;qCAAO;oBACL,IAAI,OAAO,cAAc;oBACzB,IAAI;wBAAE,OAAO,OAAO,EAAE;oBAAa,EAAE,OAAM,CAAC;oBAC5C,OAAO,OAAO,GAAG;gBACnB;;QACF;4BAAG;QAAC;QAAQ;QAAM;QAAS;KAAU;IAErC,qBACE,oNAAC;QAAI,WAAW;YAAC;YAA8D;SAAU,CAAC,IAAI,CAAC;QAC7F,OAAO;YAAE,QAAQ;YAAQ,OAAO;QAAO;;YAEtC,CAAC,uBACA,oNAAC;gBAAI,WAAU;0BAA0E;;;;;;0BAI3F,oNAAC;gBAAI,KAAK;gBAAK,WAAU;;;;;;;;;;;;AAG/B;GApEwB;KAAA","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/VoiceButton.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useRef, useState } from \"react\";\n\ntype VoiceButtonProps = {\n  onTranscribe?: (text: string) => void;\n  className?: string;\n};\n\ntype State = \"idle\" | \"recording\" | \"transcribing\" | \"done\" | \"error\";\n\nexport default function VoiceButton({ onTranscribe, className = \"\" }: VoiceButtonProps) {\n  const [state, setState] = useState<State>(\"idle\");\n  const [message, setMessage] = useState<string>(\"\");\n  const [mode] = useState<\"service\" | \"iflytek\" | \"browser\">(\"iflytek\");\n  const streamRef = useRef<MediaStream | null>(null);\n  const recRef = useRef<MediaRecorder | null>(null);\n  const chunksRef = useRef<BlobPart[]>([]);\n  const wsRef = useRef<WebSocket | null>(null);\n  const audioCtxRef = useRef<AudioContext | null>(null);\n  const processorRef = useRef<ScriptProcessorNode | null>(null);\n  const textRef = useRef<string>(\"\");\n  const tokensRef = useRef<string[]>([]); // 累积识别词元，支持 wpgs 动态修正\n\n  // 将 Float32 PCM 转为 16bit PCM 并 base64\n  const floatTo16kBase64 = (input: Float32Array, inputSampleRate: number, targetRate = 16000) => {\n    let samples = input;\n    if (inputSampleRate !== targetRate) {\n      const ratio = inputSampleRate / targetRate;\n      const newLength = Math.round(input.length / ratio);\n      const resampled = new Float32Array(newLength);\n      for (let i = 0; i < newLength; i++) {\n        const idx = Math.round(i * ratio);\n        resampled[i] = input[Math.min(idx, input.length - 1)];\n      }\n      samples = resampled;\n    }\n    const buffer = new ArrayBuffer(samples.length * 2);\n    const view = new DataView(buffer);\n    for (let i = 0; i < samples.length; i++) {\n      let s = Math.max(-1, Math.min(1, samples[i]));\n      view.setInt16(i * 2, s < 0 ? s * 0x8000 : s * 0x7fff, true);\n    }\n    const u8 = new Uint8Array(buffer);\n    let binary = \"\";\n    const chunkSize = 0x8000;\n    for (let i = 0; i < u8.length; i += chunkSize) {\n      binary += String.fromCharCode.apply(null, Array.from(u8.subarray(i, i + chunkSize)) as any);\n    }\n    return btoa(binary);\n  };\n\n  const parseIatText = (msg: any) => {\n    try {\n      const ws = msg?.data?.result?.ws || [];\n      const parts: string[] = [];\n      for (const w of ws) {\n        const cw = w?.cw || [];\n        if (cw[0]?.w) parts.push(cw[0].w);\n      }\n      return parts.join(\"\");\n    } catch {\n      return \"\";\n    }\n  };\n\n  const startIflytek = async () => {\n    try {\n      const signRes = await fetch(\"/api/voice/iflytek/sign\");\n      if (signRes.status === 501) {\n        setState(\"error\");\n        setMessage(\"未配置讯飞密钥，请在 .env.local 配置 IFLYTEK_APP_ID/KEY/SECRET\");\n        return;\n      }\n      const { wsUrl, appId } = await signRes.json();\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      streamRef.current = stream;\n      // 使用默认设备采样率，避免部分浏览器不支持强制 16000 采样率\n      const AC: any = (window as any).AudioContext || (window as any).webkitAudioContext;\n      const audioCtx = new AC();\n      audioCtxRef.current = audioCtx;\n      const source = audioCtx.createMediaStreamSource(stream);\n      const processor = audioCtx.createScriptProcessor(4096, 1, 1);\n      processorRef.current = processor;\n\n      const ws = new WebSocket(wsUrl);\n      wsRef.current = ws;\n      textRef.current = \"\";\n      setState(\"recording\");\n      setMessage(\"录音中（讯飞）...\");\n\n      ws.onopen = () => {\n        // 发送开始帧\n        const startFrame = {\n          common: { app_id: appId },\n          business: {\n            language: \"zh_cn\",\n            domain: \"iat\",\n            accent: \"mandarin\",\n            // 启用动态修正以便实时返回片段\n            dwa: \"wpgs\",\n            vad_eos: 5000,\n          },\n          data: {\n            status: 0,\n            format: \"audio/L16;rate=16000\",\n            encoding: \"raw\",\n            audio: \"\",\n          },\n        };\n        ws.send(JSON.stringify(startFrame));\n\n        processor.onaudioprocess = (e: AudioProcessingEvent) => {\n          const input = e.inputBuffer.getChannelData(0);\n          const base64 = floatTo16kBase64(input, audioCtx.sampleRate, 16000);\n          const frame = {\n            data: {\n              status: 1,\n              format: \"audio/L16;rate=16000\",\n              encoding: \"raw\",\n              audio: base64,\n            },\n          };\n          ws.send(JSON.stringify(frame));\n        };\n        source.connect(processor);\n        processor.connect(audioCtx.destination);\n        tokensRef.current = [];\n      };\n\n      ws.onmessage = async (ev: MessageEvent) => {\n        try {\n          let data: any;\n          if (typeof ev.data === \"string\") {\n            data = JSON.parse(ev.data);\n          } else if (ev.data instanceof Blob) {\n            data = JSON.parse(await ev.data.text());\n          } else if (ev.data instanceof ArrayBuffer) {\n            data = JSON.parse(new TextDecoder().decode(ev.data));\n          } else {\n            data = ev.data;\n          }\n          if (data.code !== 0) {\n            setState(\"error\");\n            setMessage(data.message || \"讯飞识别错误\");\n            return;\n          }\n          const status = data?.data?.status;\n          const result = data?.data?.result || {};\n          const wsArr = result.ws || [];\n          const pgs = result.pgs; // 'apd' 追加 或 'rpl' 替换\n          const rg = result.rg || []; // [start, end] 1-based\n\n          const words: string[] = [];\n          for (const w of wsArr) {\n            const cw = w?.cw || [];\n            if (cw[0]?.w) words.push(cw[0].w);\n          }\n\n          if (words.length) {\n            if (pgs === \"rpl\" && Array.isArray(rg) && rg.length === 2) {\n              const start = Math.max(0, Number(rg[0]) - 1);\n              const end = Math.min(tokensRef.current.length, Number(rg[1]));\n              tokensRef.current.splice(start, end - start, ...words);\n            } else {\n              tokensRef.current.push(...words);\n            }\n\n            const full = tokensRef.current.join(\"\");\n            setMessage(full);\n            textRef.current = full;\n\n            if (status === 2) {\n              setState(\"done\");\n              onTranscribe?.(full);\n              try { ws.close(); } catch {}\n            }\n          }\n        } catch (e: any) {\n          setState(\"error\");\n          setMessage(e?.message || \"讯飞消息解析失败\");\n        }\n      };\n\n      ws.onerror = () => {\n        // 连接失败时提示并保持错误状态，不回退，以确保使用讯飞方案\n        try {\n          source.disconnect();\n          processor.disconnect();\n          if (audioCtx.state !== \"closed\") audioCtx.close();\n          stream.getTracks().forEach(t => t.stop());\n        } catch {}\n        setState(\"error\");\n        setMessage(\"讯飞连接错误，请检查密钥、系统时间或网络\");\n      };\n\n      ws.onclose = (ev: CloseEvent) => {\n        if (textRef.current) {\n          setState(\"done\");\n          onTranscribe?.(textRef.current);\n        } else if (state === \"recording\") {\n          // 若正在录音被关闭，则恢复为空闲\n          setState(\"idle\");\n          setMessage(\"已停止\");\n        }\n        // 清理资源\n        try {\n          source.disconnect();\n          processor.disconnect();\n          if (audioCtx.state !== \"closed\") audioCtx.close();\n          stream.getTracks().forEach(t => t.stop());\n        } catch {}\n      };\n    } catch (e: any) {\n      setState(\"error\");\n      setMessage(e?.message || \"讯飞启动失败\");\n    }\n  };\n\n  // 浏览器语音识别回退\n  const startBrowserSpeech = () => {\n    const SR: any = (window as any).webkitSpeechRecognition || (window as any).SpeechRecognition;\n    if (!SR) {\n      setState(\"error\");\n      setMessage(\"浏览器不支持 Web Speech API\");\n      return;\n    }\n    const recog = new SR();\n    recog.lang = \"zh-CN\";\n    recog.continuous = false;\n    recog.interimResults = false;\n    setState(\"recording\");\n    recog.onresult = (ev: any) => {\n      const text = ev.results?.[0]?.[0]?.transcript || \"\";\n      setState(\"done\");\n      setMessage(text);\n      onTranscribe?.(text);\n    };\n    recog.onerror = (e: any) => {\n      setState(\"error\");\n      setMessage(e?.message || \"识别失败\");\n    };\n    recog.onend = () => {\n      if (state === \"recording\") setState(\"idle\");\n    };\n    recog.start();\n  };\n\n  const startRecording = async () => {\n    await startIflytek();\n  };\n\n  const stopRecording = () => {\n    // 发送结束帧（若连接已打开）\n    try {\n      if (wsRef.current && wsRef.current.readyState === WebSocket.OPEN) {\n        wsRef.current.send(\n          JSON.stringify({ data: { status: 2, format: \"audio/L16;rate=16000\", encoding: \"raw\", audio: \"\" } })\n        );\n      }\n    } catch {}\n\n    // 停止音频处理与关闭连接\n    try { if (processorRef.current) { (processorRef.current as any).onaudioprocess = null; processorRef.current.disconnect(); } } catch {}\n    try { if (audioCtxRef.current && audioCtxRef.current.state !== \"closed\") { audioCtxRef.current.close(); } } catch {}\n    // 允许服务端返回最终结果，再延迟关闭 WebSocket\n    try {\n      if (wsRef.current) {\n        const ws = wsRef.current;\n        setTimeout(() => { try { if (ws.readyState === WebSocket.OPEN) ws.close(); } catch {} }, 800);\n      }\n    } catch {}\n\n    processorRef.current = null;\n    audioCtxRef.current = null;\n    wsRef.current = null;\n\n    // 停止麦克风流\n    try { streamRef.current?.getTracks().forEach((t) => t.stop()); } catch {}\n    streamRef.current = null;\n\n    // 切为“转写中”，提示稍后生成路线\n    setState(\"transcribing\");\n    setMessage(\"已停止，处理中...\");\n  };\n\n  useEffect(() => () => stopRecording(), []);\n\n  return (\n    <div className={[\"flex items-center gap-2\", className].join(\" \")}>\n      <button\n        className=\"rounded bg-black px-3 py-1.5 text-white disabled:opacity-60\"\n        onClick={state === \"recording\" ? stopRecording : startRecording}\n      >\n        {state === \"recording\" ? \"停止\" : \"语音输入\"}\n      </button>\n      {/* 固定使用讯飞识别，不展示模式选择 */}\n      <span className=\"text-xs text-zinc-500\">{message}</span>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 481, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/Card.tsx"],"sourcesContent":["\"use client\";\nimport React from \"react\";\n\ntype CardProps = {\n  title?: string;\n  actions?: React.ReactNode;\n  className?: string;\n  children?: React.ReactNode;\n};\n\nexport default function Card({ title, actions, className = \"\", children }: CardProps) {\n  return (\n    <div className={[\"rounded-xl border border-gray-200 bg-white shadow-sm\", className].join(\" \")}> \n      {(title || actions) && (\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-100\">\n          <h3 className=\"text-sm font-semibold text-gray-900\">{title}</h3>\n          {actions}\n        </div>\n      )}\n      <div className=\"p-4\">{children}</div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;;AAUe,SAAS,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,YAAY,EAAE,EAAE,QAAQ,EAAa;IAClF,qBACE,oNAAC;QAAI,WAAW;YAAC;YAAwD;SAAU,CAAC,IAAI,CAAC;;YACtF,CAAC,SAAS,OAAO,mBAChB,oNAAC;gBAAI,WAAU;;kCACb,oNAAC;wBAAG,WAAU;kCAAuC;;;;;;oBACpD;;;;;;;0BAGL,oNAAC;gBAAI,WAAU;0BAAO;;;;;;;;;;;;AAG5B;KAZwB","debugId":null}},
    {"offset": {"line": 538, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/Badge.tsx"],"sourcesContent":["\"use client\";\nimport React from \"react\";\n\ntype BadgeProps = {\n  children: React.ReactNode;\n  variant?: \"default\" | \"success\" | \"warning\" | \"gray\";\n  className?: string;\n};\n\nconst variants: Record<NonNullable<BadgeProps[\"variant\"]>, string> = {\n  default: \"bg-indigo-50 text-indigo-700 ring-indigo-200\",\n  success: \"bg-emerald-50 text-emerald-700 ring-emerald-200\",\n  warning: \"bg-amber-50 text-amber-700 ring-amber-200\",\n  gray: \"bg-gray-100 text-gray-700 ring-gray-200\",\n};\n\nexport default function Badge({ children, variant = \"default\", className = \"\" }: BadgeProps) {\n  return (\n    <span\n      className={[\n        \"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset\",\n        variants[variant],\n        className,\n      ].join(\" \")}\n    >\n      {children}\n    </span>\n  );\n}"],"names":[],"mappings":";;;;;AAAA;;AASA,MAAM,WAA+D;IACnE,SAAS;IACT,SAAS;IACT,SAAS;IACT,MAAM;AACR;AAEe,SAAS,MAAM,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,YAAY,EAAE,EAAc;IACzF,qBACE,oNAAC;QACC,WAAW;YACT;YACA,QAAQ,CAAC,QAAQ;YACjB;SACD,CAAC,IAAI,CAAC;kBAEN;;;;;;AAGP;KAZwB","debugId":null}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/components/BudgetPanel.tsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useMemo, useState } from \"react\";\n\ntype PriceRange = [number, number];\ntype DiningItem = { name: string; priceRange?: PriceRange };\ntype LodgingItem = { name: string; price?: number };\ntype TransportSummary = { mode?: string; timeEstimate?: number; priceEstimate?: number };\ntype AttractionItem = { name: string; ticket?: number | string };\ntype PlanItem = { id: string; time?: string; title: string; note?: string };\ntype PlanDay = {\n  date: string;\n  items: PlanItem[];\n  dining?: DiningItem[];\n  lodging?: LodgingItem[];\n  transport?: TransportSummary;\n  attractions?: AttractionItem[];\n};\n\ntype BudgetPanelProps = {\n  days: PlanDay[];\n};\n\nfunction avgPrice(range?: PriceRange): number {\n  if (!range || range.length !== 2) return 0;\n  const a = Number(range[0]);\n  const b = Number(range[1]);\n  if (Number.isFinite(a) && Number.isFinite(b)) return (a + b) / 2;\n  return 0;\n}\n\nfunction ticketToNumber(t?: number | string): number {\n  if (t == null) return 0;\n  if (typeof t === \"number\" && Number.isFinite(t)) return t;\n  const n = Number(t);\n  return Number.isFinite(n) ? n : 0;\n}\n\nexport default function BudgetPanel({ days }: BudgetPanelProps) {\n  const [totalBudget, setTotalBudget] = useState<number | null>(null);\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"lastPrefs\");\n      if (raw) {\n        const p = JSON.parse(raw);\n        if (typeof p?.budgetTotal === \"number\") setTotalBudget(p.budgetTotal);\n      }\n    } catch {}\n  }, []);\n\n  const { byDay, totals } = useMemo(() => {\n    const byDay: { date: string; transport: number; dining: number; lodging: number; tickets: number; total: number }[] = [];\n    let transport = 0, dining = 0, lodging = 0, tickets = 0;\n    for (const d of days || []) {\n      const t = Number(d.transport?.priceEstimate) || 0;\n      const dine = (d.dining || []).reduce((s, it) => s + avgPrice(it.priceRange), 0);\n      const lodge = (d.lodging || []).reduce((s, it) => s + (Number(it.price) || 0), 0);\n      const tick = (d.attractions || []).reduce((s, it) => s + ticketToNumber(it.ticket), 0);\n      const total = t + dine + lodge + tick;\n      byDay.push({ date: d.date, transport: t, dining: dine, lodging: lodge, tickets: tick, total });\n      transport += t; dining += dine; lodging += lodge; tickets += tick;\n    }\n    const grand = transport + dining + lodging + tickets;\n    return { byDay, totals: { transport, dining, lodging, tickets, grand } };\n  }, [days]);\n\n  const maxCategory = Math.max(1, totals.grand, totals.transport, totals.dining, totals.lodging, totals.tickets);\n\n  return (\n    <div className=\"rounded-lg border border-zinc-200 p-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"text-sm font-medium\">预算管理</div>\n        {typeof totalBudget === \"number\" ? (\n          <div className=\"text-xs text-zinc-600\">总预算：<span className=\"font-semibold text-zinc-900\">¥{Math.round(totalBudget)}</span></div>\n        ) : (\n          <div className=\"text-xs text-zinc-500\">未设置总预算（偏好中可设置）</div>\n        )}\n      </div>\n\n      <div className=\"mt-3 grid grid-cols-1 gap-3\">\n        <div>\n          <div className=\"text-xs text-zinc-600\">估算总支出</div>\n          <div className=\"mt-1 text-sm\">\n            <span className=\"font-semibold\">¥{Math.round(totals.grand)}</span>\n            {typeof totalBudget === \"number\" && (\n              <span className=\"ml-2 text-xs text-zinc-500\">（剩余：¥{Math.round(totalBudget - totals.grand)}）</span>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2\">\n          {[\n            { label: \"交通\", value: totals.transport, color: \"bg-blue-500\" },\n            { label: \"餐饮\", value: totals.dining, color: \"bg-orange-500\" },\n            { label: \"住宿\", value: totals.lodging, color: \"bg-purple-500\" },\n            { label: \"门票\", value: totals.tickets, color: \"bg-emerald-500\" },\n          ].map((c) => (\n            <div key={c.label} className=\"text-xs\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-zinc-600\">{c.label}</span>\n                <span className=\"text-zinc-900\">¥{Math.round(c.value)}</span>\n              </div>\n              <div className=\"mt-1 h-2 rounded bg-zinc-100\">\n                <div className={[\"h-2 rounded\", c.color].join(\" \")}\n                  style={{ width: `${Math.min(100, (c.value / maxCategory) * 100)}%` }}\n                />\n              </div>\n            </div>\n          ))}\n        </div>\n\n        <div className=\"mt-2\">\n          <div className=\"text-xs text-zinc-600 mb-1\">按天估算</div>\n          <div className=\"space-y-1\">\n            {byDay.map((d) => (\n              <div key={d.date} className=\"flex items-center justify-between text-xs\">\n                <span className=\"text-zinc-600\">{d.date}</span>\n                <span className=\"text-zinc-900\">¥{Math.round(d.total)}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AACA;;;AADA;;AAsBA,SAAS,SAAS,KAAkB;IAClC,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO;IACzC,MAAM,IAAI,OAAO,KAAK,CAAC,EAAE;IACzB,MAAM,IAAI,OAAO,KAAK,CAAC,EAAE;IACzB,IAAI,OAAO,QAAQ,CAAC,MAAM,OAAO,QAAQ,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI;IAC/D,OAAO;AACT;AAEA,SAAS,eAAe,CAAmB;IACzC,IAAI,KAAK,MAAM,OAAO;IACtB,IAAI,OAAO,MAAM,YAAY,OAAO,QAAQ,CAAC,IAAI,OAAO;IACxD,MAAM,IAAI,OAAO;IACjB,OAAO,OAAO,QAAQ,CAAC,KAAK,IAAI;AAClC;AAEe,SAAS,YAAY,EAAE,IAAI,EAAoB;;IAC5D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,gMAAQ,EAAgB;IAE9D,IAAA,iMAAS;iCAAC;YACR,IAAI;gBACF,MAAM,MAAM,aAAa,OAAO,CAAC;gBACjC,IAAI,KAAK;oBACP,MAAM,IAAI,KAAK,KAAK,CAAC;oBACrB,IAAI,OAAO,GAAG,gBAAgB,UAAU,eAAe,EAAE,WAAW;gBACtE;YACF,EAAE,OAAM,CAAC;QACX;gCAAG,EAAE;IAEL,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,IAAA,+LAAO;+BAAC;YAChC,MAAM,QAAgH,EAAE;YACxH,IAAI,YAAY,GAAG,SAAS,GAAG,UAAU,GAAG,UAAU;YACtD,KAAK,MAAM,KAAK,QAAQ,EAAE,CAAE;gBAC1B,MAAM,IAAI,OAAO,EAAE,SAAS,EAAE,kBAAkB;gBAChD,MAAM,OAAO,CAAC,EAAE,MAAM,IAAI,EAAE,EAAE,MAAM;gDAAC,CAAC,GAAG,KAAO,IAAI,SAAS,GAAG,UAAU;+CAAG;gBAC7E,MAAM,QAAQ,CAAC,EAAE,OAAO,IAAI,EAAE,EAAE,MAAM;iDAAC,CAAC,GAAG,KAAO,IAAI,CAAC,OAAO,GAAG,KAAK,KAAK,CAAC;gDAAG;gBAC/E,MAAM,OAAO,CAAC,EAAE,WAAW,IAAI,EAAE,EAAE,MAAM;gDAAC,CAAC,GAAG,KAAO,IAAI,eAAe,GAAG,MAAM;+CAAG;gBACpF,MAAM,QAAQ,IAAI,OAAO,QAAQ;gBACjC,MAAM,IAAI,CAAC;oBAAE,MAAM,EAAE,IAAI;oBAAE,WAAW;oBAAG,QAAQ;oBAAM,SAAS;oBAAO,SAAS;oBAAM;gBAAM;gBAC5F,aAAa;gBAAG,UAAU;gBAAM,WAAW;gBAAO,WAAW;YAC/D;YACA,MAAM,QAAQ,YAAY,SAAS,UAAU;YAC7C,OAAO;gBAAE;gBAAO,QAAQ;oBAAE;oBAAW;oBAAQ;oBAAS;oBAAS;gBAAM;YAAE;QACzE;8BAAG;QAAC;KAAK;IAET,MAAM,cAAc,KAAK,GAAG,CAAC,GAAG,OAAO,KAAK,EAAE,OAAO,SAAS,EAAE,OAAO,MAAM,EAAE,OAAO,OAAO,EAAE,OAAO,OAAO;IAE7G,qBACE,oNAAC;QAAI,WAAU;;0BACb,oNAAC;gBAAI,WAAU;;kCACb,oNAAC;wBAAI,WAAU;kCAAsB;;;;;;oBACpC,OAAO,gBAAgB,yBACtB,oNAAC;wBAAI,WAAU;;4BAAwB;0CAAI,oNAAC;gCAAK,WAAU;;oCAA8B;oCAAE,KAAK,KAAK,CAAC;;;;;;;;;;;;6CAEtG,oNAAC;wBAAI,WAAU;kCAAwB;;;;;;;;;;;;0BAI3C,oNAAC;gBAAI,WAAU;;kCACb,oNAAC;;0CACC,oNAAC;gCAAI,WAAU;0CAAwB;;;;;;0CACvC,oNAAC;gCAAI,WAAU;;kDACb,oNAAC;wCAAK,WAAU;;4CAAgB;4CAAE,KAAK,KAAK,CAAC,OAAO,KAAK;;;;;;;oCACxD,OAAO,gBAAgB,0BACtB,oNAAC;wCAAK,WAAU;;4CAA6B;4CAAM,KAAK,KAAK,CAAC,cAAc,OAAO,KAAK;4CAAE;;;;;;;;;;;;;;;;;;;kCAKhG,oNAAC;wBAAI,WAAU;kCACZ;4BACC;gCAAE,OAAO;gCAAM,OAAO,OAAO,SAAS;gCAAE,OAAO;4BAAc;4BAC7D;gCAAE,OAAO;gCAAM,OAAO,OAAO,MAAM;gCAAE,OAAO;4BAAgB;4BAC5D;gCAAE,OAAO;gCAAM,OAAO,OAAO,OAAO;gCAAE,OAAO;4BAAgB;4BAC7D;gCAAE,OAAO;gCAAM,OAAO,OAAO,OAAO;gCAAE,OAAO;4BAAiB;yBAC/D,CAAC,GAAG,CAAC,CAAC,kBACL,oNAAC;gCAAkB,WAAU;;kDAC3B,oNAAC;wCAAI,WAAU;;0DACb,oNAAC;gDAAK,WAAU;0DAAiB,EAAE,KAAK;;;;;;0DACxC,oNAAC;gDAAK,WAAU;;oDAAgB;oDAAE,KAAK,KAAK,CAAC,EAAE,KAAK;;;;;;;;;;;;;kDAEtD,oNAAC;wCAAI,WAAU;kDACb,cAAA,oNAAC;4CAAI,WAAW;gDAAC;gDAAe,EAAE,KAAK;6CAAC,CAAC,IAAI,CAAC;4CAC5C,OAAO;gDAAE,OAAO,GAAG,KAAK,GAAG,CAAC,KAAK,AAAC,EAAE,KAAK,GAAG,cAAe,KAAK,CAAC,CAAC;4CAAC;;;;;;;;;;;;+BAP/D,EAAE,KAAK;;;;;;;;;;kCAcrB,oNAAC;wBAAI,WAAU;;0CACb,oNAAC;gCAAI,WAAU;0CAA6B;;;;;;0CAC5C,oNAAC;gCAAI,WAAU;0CACZ,MAAM,GAAG,CAAC,CAAC,kBACV,oNAAC;wCAAiB,WAAU;;0DAC1B,oNAAC;gDAAK,WAAU;0DAAiB,EAAE,IAAI;;;;;;0DACvC,oNAAC;gDAAK,WAAU;;oDAAgB;oDAAE,KAAK,KAAK,CAAC,EAAE,KAAK;;;;;;;;uCAF5C,EAAE,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAU9B;GAxFwB;KAAA","debugId":null}},
    {"offset": {"line": 917, "column": 0}, "map": {"version":3,"sources":["file:///Users/lujinlei/Documents/code/AI-Travel-Homework/AI-Travel/web/src/app/plan/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport MapView from \"@/components/MapView\";\nimport VoiceButton from \"@/components/VoiceButton\";\nimport Card from \"@/components/Card\";\nimport Badge from \"@/components/Badge\";\nimport Button from \"@/components/Button\";\nimport BudgetPanel from \"@/components/BudgetPanel\";\nimport type { PlanDay } from \"@/lib/itinerarySchema\";\n\nfunction useRouteQuery(params: { origin?: string; destination?: string; type?: string; originCoord?: string; destinationCoord?: string }) {\n  const { origin = \"北京站\", destination = \"天安门\", type = \"driving\", originCoord = \"116.4336,39.9024\", destinationCoord = \"116.3975,39.9087\" } = params;\n  return useQuery({\n    queryKey: [\"route\", origin, destination, originCoord, destinationCoord, type],\n    queryFn: async () => {\n      const u = new URL(\"/api/map/route\", window.location.origin);\n      u.searchParams.set(\"origin\", originCoord);\n      u.searchParams.set(\"destination\", destinationCoord);\n      u.searchParams.set(\"type\", type);\n      const res = await fetch(u.toString());\n      if (res.status === 501) {\n        // 后端未配置 AMAP_WEBSERVICE_KEY 时返回 501，占位忽略错误以避免打断页面\n        return null;\n      }\n      if (!res.ok) {\n        const msg = await res.text().catch(() => \"route api error\");\n        throw new Error(msg || \"route api error\");\n      }\n      return res.json();\n    },\n    enabled: !!originCoord && !!destinationCoord,\n  });\n}\n\n// 已移除搜索地点与城市的显式UI；仍保留内部解析以支持语音与手动查询\n\nexport default function PlanPage() {\n  const [origin, setOrigin] = useState(\"北京站\");\n  const [destination, setDestination] = useState(\"天安门\");\n  const [originCoord, setOriginCoord] = useState(\"116.4336,39.9024\");\n  const [destinationCoord, setDestinationCoord] = useState(\"116.3975,39.9087\");\n  const [type, setType] = useState(\"driving\");\n  const [selectedDay, setSelectedDay] = useState<number>(0);\n  const [highlightItemId, setHighlightItemId] = useState<string | null>(null);\n  const [focusMarkers, setFocusMarkers] = useState<{ position: [number, number]; title?: string }[]>([]);\n  const [filterText, setFilterText] = useState(\"\");\n  const [timeFilter, setTimeFilter] = useState<\"all\" | \"morning\" | \"afternoon\" | \"evening\">(\"all\");\n  const [showPrefs, setShowPrefs] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [genError, setGenError] = useState<string | null>(null);\n  const [destInput, setDestInput] = useState(\"\");\n  const [startInput, setStartInput] = useState(\"\");\n  const [endInput, setEndInput] = useState(\"\");\n  const [pace, setPace] = useState<\"relaxed\" | \"standard\" | \"intense\">(\"standard\");\n  const [interestsText, setInterestsText] = useState(\"\");\n  const [budgetInput, setBudgetInput] = useState<string>(\"\");\n\n  // 主页生成的行程数据（localStorage 注入）\n  const [plan, setPlan] = useState<null | { destination: string; start_date: string; end_date: string; days: PlanDay[]; markers?: { position: [number, number]; title?: string }[]; source?: \"llm\" | \"fallback\" }>(null);\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"lastPlan\");\n      if (raw) {\n        const obj = JSON.parse(raw);\n        if (obj && obj.destination && obj.days) setPlan(obj);\n      }\n      const prefsRaw = localStorage.getItem(\"lastPrefs\");\n      if (prefsRaw) {\n        const pj = JSON.parse(prefsRaw);\n        if (pj?.pace) setPace(pj.pace);\n        if (Array.isArray(pj?.interests)) setInterestsText(pj.interests.join(\", \"));\n        if (typeof pj?.budgetTotal === \"number\") setBudgetInput(String(pj.budgetTotal));\n      }\n    } catch {}\n  }, []);\n\n  useEffect(() => {\n    // 行程更新时默认选中第 1 天并清空高亮\n    setSelectedDay(0);\n    setHighlightItemId(null);\n    setFocusMarkers([]);\n  }, [plan?.destination, plan?.start_date, plan?.end_date, plan?.days?.length]);\n\n  useEffect(() => {\n    if (showPrefs && plan) {\n      setDestInput(plan.destination || \"\");\n      setStartInput(plan.start_date || \"\");\n      setEndInput(plan.end_date || \"\");\n    }\n  }, [showPrefs]);\n\n  const { data, isLoading, error, refetch } = useRouteQuery({ origin, destination, originCoord, destinationCoord, type });\n\n  const routePath = data?.polyline ?? [];\n  const planMarkers = useMemo(() => plan?.markers ?? [], [plan]);\n  const markersToRender = focusMarkers.length ? focusMarkers : planMarkers;\n  const center = focusMarkers.length\n    ? focusMarkers[0].position\n    : routePath.length\n    ? routePath[0]\n    : planMarkers.length\n    ? planMarkers[0].position\n    : [116.397428, 39.90923];\n\n  // 解析“从xxx到xxx”并生成路线\n  const handleTranscribe = async (text: string) => {\n    // 清理换行/多余空格/句末标点，并解析“从xxx到xxx”\n    const cleaned = String(text)\n      .replace(/[\\n\\r]+/g, \" \")\n      .replace(/\\s+/g, \" \")\n      .replace(/[，,。.!！?？]+$/g, \"\")\n      .trim();\n    const m = cleaned.match(/从\\s*(.+?)\\s*到\\s*(.+)$/);\n    if (!m) {\n      // 不匹配则忽略\n      return;\n    }\n    const fromName = m[1].trim();\n    const toName = m[2].trim();\n\n    const extractCity = (n: string) => {\n      const cities = [\n        \"北京\",\"天津\",\"上海\",\"重庆\",\"广州\",\"深圳\",\"杭州\",\"苏州\",\"南京\",\"武汉\",\"成都\",\"西安\",\"青岛\",\"大连\",\"沈阳\",\"长春\",\"哈尔滨\",\"济南\",\"郑州\",\"佛山\",\"宁波\",\"无锡\",\"厦门\",\"福州\",\"合肥\",\"长沙\",\"南昌\",\"昆明\",\"石家庄\",\"太原\",\"兰州\",\"呼和浩特\",\"贵阳\",\"南宁\",\"海口\",\"唐山\",\"保定\"\n      ];\n      for (const c of cities) {\n        if (n.includes(c)) return c;\n      }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)市/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name);\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const norm = (s: string) => s.replace(/\\s+/g, \"\").toLowerCase();\n      const target = norm(name);\n      const exact = pois.find((p: any) => norm(p.name) === target);\n      if (exact) return { name, coord: `${exact.location.lng},${exact.location.lat}` };\n      const byCity = city ? pois.find((p: any) => (p.cityname?.includes(city) || p.adname?.includes(city)) && norm(p.name).includes(target)) : null;\n      const poi = byCity || pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}` };\n    };\n\n    // 先把左侧输入同步为语音文本\n    setOrigin(fromName);\n    setDestination(toName);\n    const from = await resolvePoi(fromName);\n    const to = await resolvePoi(toName);\n\n    if (from) setOriginCoord(from.coord);\n    if (to) setDestinationCoord(to.coord);\n\n    // 触发路线查询\n    refetch();\n  };\n\n  // 根据经纬度在地图上定位并高亮\n  const handleLocatePoint = (lat: number, lng: number, title?: string) => {\n    if (!Number.isFinite(lat) || !Number.isFinite(lng)) return;\n    setFocusMarkers([{ position: [lng, lat], title }]);\n    // 清除路线以突出标记\n    setOriginCoord(\"\");\n    setDestinationCoord(\"\");\n  };\n\n  // 根据名称解析坐标并定位（优先使用计划目的地作为城市范围）\n  const locateByPlaceName = async (name: string) => {\n    const extractCity = (n: string) => {\n      const cities = [\n        \"北京\",\"天津\",\"上海\",\"重庆\",\"广州\",\"深圳\",\"杭州\",\"苏州\",\"南京\",\"武汉\",\"成都\",\"西安\",\"青岛\",\"大连\",\"沈阳\",\"长春\",\"哈尔滨\",\"济南\",\"郑州\",\"佛山\",\"宁波\",\"无锡\",\"厦门\",\"福州\",\"合肥\",\"长沙\",\"南昌\",\"昆明\",\"石家庄\",\"太原\",\"兰州\",\"呼和浩特\",\"贵阳\",\"南宁\",\"海口\",\"唐山\",\"保定\"\n      ];\n      for (const c of cities) { if ((plan?.destination || \"\").includes(c) || n.includes(c)) return c; }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)市/);\n      if (m) return m[1];\n      return (plan?.destination || \"\");\n    };\n    const city = extractCity(name || plan?.destination || \"\");\n    const u = new URL(\"/api/map/search\", window.location.origin);\n    u.searchParams.set(\"query\", name);\n    if (city) u.searchParams.set(\"city\", city);\n    const resp = await fetch(u.toString());\n    if (!resp.ok) return;\n    const jd = await resp.json().catch(() => null);\n    const pois: any[] = jd?.pois || [];\n    if (!pois.length) return;\n    const poi = pois[0];\n    const lng = Number(poi.location?.lng);\n    const lat = Number(poi.location?.lat);\n    if (Number.isFinite(lat) && Number.isFinite(lng)) {\n      handleLocatePoint(lat, lng, name);\n    }\n  };\n\n  // 手动查询按钮：若坐标未与名称匹配，则自动解析坐标\n  const handleQueryRoute = async () => {\n    const extractCity = (n: string) => {\n      const cities = [\n        \"北京\",\"天津\",\"上海\",\"重庆\",\"广州\",\"深圳\",\"杭州\",\"苏州\",\"南京\",\"武汉\",\"成都\",\"西安\",\"青岛\",\"大连\",\"沈阳\",\"长春\",\"哈尔滨\",\"济南\",\"郑州\",\"佛山\",\"宁波\",\"无锡\",\"厦门\",\"福州\",\"合肥\",\"长沙\",\"南昌\",\"昆明\",\"石家庄\",\"太原\",\"兰州\",\"呼和浩特\",\"贵阳\",\"南宁\",\"海口\",\"唐山\",\"保定\"\n      ];\n      for (const c of cities) {\n        if (n.includes(c)) return c;\n      }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)市/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name);\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const norm = (s: string) => s.replace(/\\s+/g, \"\").toLowerCase();\n      const target = norm(name);\n      const exact = pois.find((p: any) => norm(p.name) === target);\n      if (exact) return { name, coord: `${exact.location.lng},${exact.location.lat}` };\n      const byCity = city ? pois.find((p: any) => (p.cityname?.includes(city) || p.adname?.includes(city)) && norm(p.name).includes(target)) : null;\n      const poi = byCity || pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}` };\n    };\n\n    // 若坐标仍是默认或未更新，则尝试用名称解析\n    if (!originCoord || originCoord === \"116.4336,39.9024\") {\n      const from = await resolvePoi(origin);\n      if (from) { setOrigin(from.name); setOriginCoord(from.coord); }\n    }\n    if (!destinationCoord || destinationCoord === \"116.3975,39.9087\") {\n      const to = await resolvePoi(destination);\n      if (to) { setDestination(to.name); setDestinationCoord(to.coord); }\n    }\n\n    refetch();\n  };\n\n  // 点击时间线条目：解析前后两点并在地图上绘制当天局部路线\n  const handleItemClick = async (dayIndex: number, itemIndex: number) => {\n    if (!plan || !plan.days[dayIndex]) return;\n    setSelectedDay(dayIndex);\n    const day = plan.days[dayIndex];\n    const cur = day.items[itemIndex];\n    setHighlightItemId(cur.id ?? null);\n\n    const extractCity = (n: string) => {\n      const cities = [\n        \"北京\",\"天津\",\"上海\",\"重庆\",\"广州\",\"深圳\",\"杭州\",\"苏州\",\"南京\",\"武汉\",\"成都\",\"西安\",\"青岛\",\"大连\",\"沈阳\",\"长春\",\"哈尔滨\",\"济南\",\"郑州\",\"佛山\",\"宁波\",\"无锡\",\"厦门\",\"福州\",\"合肥\",\"长沙\",\"南昌\",\"昆明\",\"石家庄\",\"太原\",\"兰州\",\"呼和浩特\",\"贵阳\",\"南宁\",\"海口\",\"唐山\",\"保定\"\n      ];\n      for (const c of cities) { if ((plan?.destination || \"\").includes(c) || n.includes(c)) return c; }\n      const m = n.match(/([\\u4e00-\\u9fa5]+)市/);\n      if (m) return m[1];\n      return \"\";\n    };\n    const resolvePoi = async (name: string) => {\n      const city = extractCity(name || plan?.destination || \"\");\n      const u = new URL(\"/api/map/search\", window.location.origin);\n      u.searchParams.set(\"query\", name);\n      if (city) u.searchParams.set(\"city\", city);\n      const resp = await fetch(u.toString());\n      if (!resp.ok) return null;\n      const jd = await resp.json().catch(() => null);\n      const pois: any[] = jd?.pois || [];\n      if (!pois.length) return null;\n      const poi = pois[0];\n      return { name, coord: `${poi.location.lng},${poi.location.lat}`, pos: [poi.location.lng, poi.location.lat] as [number, number] };\n    };\n\n    // 前一个点（若不存在则使用当天第一个或默认起点名）\n    const prev = day.items[itemIndex - 1];\n    const fromName = (prev as any)?.place?.name || prev?.title || (day.items[0] as any)?.place?.name || day.items[0]?.title || origin;\n    const toName = (cur as any)?.place?.name || cur.title;\n    const from = await resolvePoi(fromName);\n    const to = await resolvePoi(toName);\n    if (!to) return;\n\n    if (from) {\n      setOrigin(from.name);\n      setOriginCoord(from.coord);\n    }\n    setDestination(to.name);\n    setDestinationCoord(to.coord);\n    setType(\"walking\");\n    setFocusMarkers([\n      from?.pos ? { position: from.pos, title: from.name } : undefined,\n      to.pos ? { position: to.pos, title: to.name } : undefined,\n    ].filter(Boolean) as { position: [number, number]; title?: string }[]);\n    refetch();\n  };\n\n  return (\n    <div className=\"p-4 space-y-4\">\n      {plan && (\n        <Card title=\"最新生成行程\" actions={<Button size=\"sm\" variant=\"secondary\" onClick={() => setShowPrefs(true)}>偏好与重新生成</Button>}>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-sm font-medium flex items-center gap-2\">\n              <span>{plan.destination}</span>\n              {plan.source === \"fallback\" ? (\n                <Badge variant=\"warning\" className=\"ml-1\">使用兜底数据</Badge>\n              ) : null}\n            </div>\n            <Badge variant=\"gray\">{plan.start_date} → {plan.end_date}</Badge>\n          </div>\n          {/* 已移除顶部筛选控件以保持头部简洁 */}\n          <div className=\"mt-3 grid grid-cols-1 gap-3 lg:grid-cols-2\">\n            {/* 左侧：日程导航（紧凑摘要） + 左下预算管理 */}\n            <div className=\"flex flex-col gap-2\">\n              {plan.days.map((d, di) => {\n                const diningCount = Array.isArray(d.dining) ? d.dining.length : 0;\n                const lodgingCount = Array.isArray(d.lodging) ? d.lodging.length : 0;\n                const attractionCount = Array.isArray(d.attractions) ? d.attractions.length : 0;\n                const transportShort = d.transport ? `${d.transport.mode || \"-\"} · ${typeof d.transport.timeEstimate === \"number\" ? `${Math.round(d.transport.timeEstimate)}m` : \"--\"} · ${typeof d.transport.priceEstimate === \"number\" ? `￥${Math.round(d.transport.priceEstimate)}` : \"--\"}` : \"无交通信息\";\n                const previewItems = (d.items || [])\n                  .slice(0, 2)\n                  .map((it: any) => `${it.time ? it.time + \" \" : \"\"}${(it?.place?.name) || it.title}`)\n                  .join(\" · \");\n                return (\n                  <button key={d.date} className={[\"w-full mb-2 rounded border p-2 text-left\", di === selectedDay ? \"border-blue-500 bg-blue-50\" : \"border-zinc-200 hover:bg-zinc-50\"].join(\" \")}\n                    onClick={() => setSelectedDay(di)}>\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-xs font-medium\">{d.date}</div>\n                      <div className=\"flex items-center gap-2 text-[11px] text-zinc-600\">\n                        <span>🍽️{diningCount}</span>\n                        <span>🏨{lodgingCount}</span>\n                        <span>📍{attractionCount}</span>\n                      </div>\n                    </div>\n                    <div className=\"mt-1 text-[11px] text-zinc-600 truncate\">{previewItems || \"无活动预览\"}</div>\n                    <div className=\"mt-1 text-[11px] text-zinc-600\">{transportShort}</div>\n                  </button>\n                );\n              })}\n              {/* 紧凑预算管理：默认展开，放置于左侧底部空白区域 */}\n              <div className=\"mt-2 rounded border border-zinc-200 bg-white/70 p-2 text-[12px] text-zinc-700\">\n                <div className=\"mb-1 flex items-center justify-between\">\n                  <div className=\"font-medium text-zinc-800\">预算管理</div>\n                </div>\n                <div className=\"max-h-[260px] overflow-y-auto\">\n                  <BudgetPanel days={plan.days as any} />\n                </div>\n              </div>\n            </div>\n            {/* 右侧：选中当天的详细信息（折叠集中显示） */}\n            <div className=\"space-y-3\">\n              <Card title={`${plan.days[selectedDay]?.date || \"\"} 详细`}>\n                {(() => {\n                  const d = plan.days[selectedDay];\n                  if (!d) return <div className=\"text-xs text-zinc-500\">无当天数据</div>;\n                  const matchText = (it: any) => {\n                    const q = filterText.trim().toLowerCase();\n                    if (!q) return true;\n                    return (\n                      String((it?.place?.name || it.title || \"\")).toLowerCase().includes(q) ||\n                      String(it.note || \"\").toLowerCase().includes(q)\n                    );\n                  };\n                  const matchTime = (it: any) => {\n                    if (timeFilter === \"all\") return true;\n                    const m = String(it.time || \"\").match(/^(\\d{1,2}):(\\d{2})/);\n                    if (!m) return true;\n                    const h = Number(m[1]);\n                    if (timeFilter === \"morning\") return h < 12;\n                    if (timeFilter === \"afternoon\") return h >= 12 && h < 17;\n                    if (timeFilter === \"evening\") return h >= 17;\n                    return true;\n                  };\n                  const items = d.items.filter((it) => matchText(it) && matchTime(it));\n                  return (\n                    <div>\n                      <ul className=\"space-y-1\">\n                        {items.map((it: any, ii) => (\n                          <li key={it.id || `${d.date}-${ii}`} className={[\"cursor-pointer rounded px-1 py-0.5 text-xs\", highlightItemId === it.id ? \"bg-blue-100 text-blue-700\" : \"text-zinc-700 hover:bg-zinc-100\"].join(\" \")}\n                              onClick={() => handleItemClick(selectedDay, ii)}>\n                            {it.time ? <span className=\"mr-2 text-zinc-500\">{it.time}</span> : null}\n                            {it?.place?.name || it.title}\n                            {it.note ? <span className=\"ml-2 text-zinc-400\">{it.note}</span> : null}\n                          </li>\n                        ))}\n                        {items.length === 0 && (\n                          <li className=\"text-[12px] text-zinc-500\">该筛选下暂无活动</li>\n                        )}\n                      </ul>\n                      {/* 交通信息 */}\n                      {d.transport && (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">交通</div>\n                          <div className=\"mt-1\">方式：{String(d.transport.mode || \"\").trim() || \"-\"}</div>\n                          {Array.isArray(d.transport.steps) && d.transport.steps.length ? (\n                            <div className=\"mt-1\">步骤：{d.transport.steps.join(\"，\")}</div>\n                          ) : null}\n                          <div className=\"mt-1\">耗时：{typeof d.transport.timeEstimate === \"number\" ? `${Math.round(d.transport.timeEstimate)} 分钟` : \"-\"}</div>\n                          <div className=\"mt-1\">费用：{typeof d.transport.priceEstimate === \"number\" ? `${Math.round(d.transport.priceEstimate)} 元` : \"-\"}</div>\n                        </div>\n                      )}\n                      {/* 餐饮列表 */}\n                      {Array.isArray(d.dining) && d.dining.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">餐饮</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.dining.map((r: any, idx: number) => (\n                              <li\n                                key={`${d.date}-dining-${idx}`}\n                                className=\"flex items-center justify-between cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (r.location && typeof r.location.lat === \"number\" && typeof r.location.lng === \"number\") {\n                                    handleLocatePoint(r.location.lat, r.location.lng, r.name);\n                                  } else {\n                                    locateByPlaceName(r.name);\n                                  }\n                                }}\n                              >\n                                <div>\n                                  <span className=\"text-zinc-800\">{r.name}</span>\n                                  {r.cuisine ? <span className=\"ml-2 text-zinc-500\">{r.cuisine}</span> : null}\n                                  {Array.isArray(r.priceRange) && r.priceRange.length === 2 ? (\n                                    <span className=\"ml-2 text-zinc-600\">￥{r.priceRange[0]}–{r.priceRange[1]}</span>\n                                  ) : null}\n                                  {typeof r.rating === \"number\" ? (\n                                    <span className=\"ml-2 text-amber-600\">评分 {r.rating}</span>\n                                  ) : null}\n                                </div>\n                                {r.location && typeof r.location.lat === \"number\" && typeof r.location.lng === \"number\" ? (\n                                  <button className=\"rounded bg-blue-500 px-2 py-0.5 text-white\" onClick={(e) => { e.stopPropagation(); handleLocatePoint(r.location.lat, r.location.lng, r.name); }}>定位</button>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                      {/* 住宿列表 */}\n                      {Array.isArray(d.lodging) && d.lodging.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">住宿</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.lodging.map((h: any, idx: number) => (\n                              <li\n                                key={`${d.date}-lodging-${idx}`}\n                                className=\"flex items-center justify-between cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (h.location && typeof h.location.lat === \"number\" && typeof h.location.lng === \"number\") {\n                                    handleLocatePoint(h.location.lat, h.location.lng, h.name);\n                                  } else {\n                                    locateByPlaceName(h.name);\n                                  }\n                                }}\n                              >\n                                <div>\n                                  <span className=\"text-zinc-800\">{h.name}</span>\n                                  {h.area ? <span className=\"ml-2 text-zinc-500\">{h.area}</span> : null}\n                                  {typeof h.price === \"number\" ? <span className=\"ml-2 text-zinc-600\">￥{h.price}</span> : null}\n                                  {typeof h.rating === \"number\" ? <span className=\"ml-2 text-amber-600\">评分 {h.rating}</span> : null}\n                                  {Array.isArray(h.amenities) && h.amenities.length ? (\n                                    <span className=\"ml-2 text-zinc-500\">{h.amenities.join(\"、\")}</span>\n                                  ) : null}\n                                </div>\n                                {h.location && typeof h.location.lat === \"number\" && typeof h.location.lng === \"number\" ? (\n                                  <button className=\"rounded bg-blue-500 px-2 py-0.5 text-white\" onClick={(e) => { e.stopPropagation(); handleLocatePoint(h.location.lat, h.location.lng, h.name); }}>定位</button>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                      {/* 景点列表 */}\n                      {Array.isArray(d.attractions) && d.attractions.length ? (\n                        <div className=\"mt-2 rounded bg-white/60 p-2 text-[12px] text-zinc-700\">\n                          <div className=\"font-medium text-zinc-800\">景点</div>\n                          <ul className=\"mt-1 space-y-1\">\n                            {d.attractions.map((a: any, idx: number) => (\n                              <li\n                                key={`${d.date}-attraction-${idx}`}\n                                className=\"cursor-pointer hover:bg-zinc-100 px-1 rounded\"\n                                onClick={() => {\n                                  if (a.location && typeof a.location.lat === \"number\" && typeof a.location.lng === \"number\") {\n                                    handleLocatePoint(a.location.lat, a.location.lng, a.name);\n                                  } else {\n                                    locateByPlaceName(a.name);\n                                  }\n                                }}\n                              >\n                                <span className=\"text-zinc-800\">{a.name}</span>\n                                {typeof a.ticket === \"number\" ? <span className=\"ml-2 text-zinc-600\">门票 ￥{a.ticket}</span> : a.ticket ? <span className=\"ml-2 text-zinc-600\">门票 {String(a.ticket)}</span> : null}\n                                {a.best_time ? <span className=\"ml-2 text-zinc-500\">最佳时段 {a.best_time}</span> : null}\n                                {a.tips ? <span className=\"ml-2 text-zinc-500\">{a.tips}</span> : null}\n                                {Array.isArray(a.photo_spots) && a.photo_spots.length ? (\n                                  <div className=\"mt-0.5 text-zinc-600\">拍照点：{a.photo_spots.join(\"、\")}</div>\n                                ) : null}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      ) : null}\n                    </div>\n                  );\n                })()}\n              </Card>\n            </div>\n          </div>\n        </Card>\n      )}\n      <div className=\"flex gap-2\">\n        <input className=\"border px-2 py-1\" placeholder=\"起点\" value={origin} onChange={(e) => setOrigin(e.target.value)} />\n        <input className=\"border px-2 py-1\" placeholder=\"终点\" value={destination} onChange={(e) => setDestination(e.target.value)} />\n        <select className=\"border px-2 py-1\" value={type} onChange={(e) => setType(e.target.value)}>\n          <option value=\"driving\">驾车</option>\n          <option value=\"walking\">步行</option>\n          <option value=\"bicycling\">骑行</option>\n        </select>\n        <button className=\"bg-blue-600 text-white px-3 py-1 rounded\" onClick={handleQueryRoute}>查询路线</button>\n        <VoiceButton onTranscribe={handleTranscribe} />\n      </div>\n      {error && <div className=\"text-red-600\">{String((error as Error)?.message)}</div>}\n      {isLoading && <div>加载中...</div>}\n      <Card title=\"地图与路线\">\n        <div className=\"relative h-[480px]\">\n          <MapView center={center as [number, number]} zoom={12} routePath={routePath} markers={markersToRender} />\n        </div>\n        {data && (\n          <div className=\"mt-3 text-sm text-gray-700\">\n            <div>距离：{Math.round(data.distance)} 米</div>\n            <div>预计耗时：{Math.round(data.duration / 60)} 分钟</div>\n          </div>\n        )}\n      </Card>\n      {showPrefs && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30\">\n          <div className=\"w-full max-w-2xl rounded-md border border-zinc-200 bg-white p-4 shadow-lg\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-sm font-medium\">偏好设置与重新生成</div>\n              <button className=\"text-zinc-500 hover:text-zinc-700\" onClick={() => setShowPrefs(false)}>关闭</button>\n            </div>\n            <div className=\"mt-3 grid grid-cols-1 gap-3 sm:grid-cols-2\">\n              <input className=\"border px-2 py-1 rounded\" placeholder=\"目的地\" value={destInput} onChange={(e) => setDestInput(e.target.value)} />\n              <div className=\"grid grid-cols-2 gap-2\">\n                <input className=\"border px-2 py-1 rounded\" type=\"date\" value={startInput} onChange={(e) => setStartInput(e.target.value)} />\n                <input className=\"border px-2 py-1 rounded\" type=\"date\" value={endInput} onChange={(e) => setEndInput(e.target.value)} />\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <div className=\"text-xs text-zinc-600 mb-1\">行程节奏</div>\n                <div className=\"flex gap-2\">\n                  {([\"relaxed\",\"standard\",\"intense\"] as const).map((p) => (\n                    <button key={p} onClick={() => setPace(p)} className={[\"rounded border px-2 py-1 text-xs\", pace===p?\"border-blue-500 bg-blue-50 text-blue-700\":\"border-zinc-300\"].join(\" \")}>{p===\"relaxed\"?\"悠闲\":p===\"standard\"?\"标准\":\"紧凑\"}</button>\n                  ))}\n                </div>\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <input className=\"border px-2 py-1 rounded w-full\" placeholder=\"兴趣偏好（逗号分隔，如：美食, 博物馆, 徒步）\" value={interestsText} onChange={(e) => setInterestsText(e.target.value)} />\n              </div>\n              <div className=\"col-span-1 sm:col-span-2\">\n                <input className=\"border px-2 py-1 rounded w-full\" type=\"number\" min=\"0\" placeholder=\"总预算（元）\" value={budgetInput} onChange={(e) => setBudgetInput(e.target.value)} />\n              </div>\n            </div>\n            {genError && <div className=\"mt-2 rounded border border-red-200 bg-red-50 p-2 text-xs text-red-700\">{genError}</div>}\n            <div className=\"mt-3 flex justify-end gap-2\">\n              <button className=\"border px-3 py-1 rounded\" onClick={() => setShowPrefs(false)}>取消</button>\n              <button className=\"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50\" onClick={async () => {\n                setGenerating(true);\n                setGenError(null);\n                try {\n                  const interests = interestsText.split(/[,，\\s]+/).map((s) => s.trim()).filter(Boolean);\n                  const body = {\n                    destination: destInput || destination,\n                    start_date: startInput || plan?.start_date || \"\",\n                    end_date: endInput || plan?.end_date || \"\",\n                    preferences: { pace, ...(interests.length ? { interests } : {}), ...(budgetInput.trim() ? { budgetTotal: Number(budgetInput) } : {}) },\n                  };\n                  const res = await fetch(\"/api/plan/create\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(body) });\n                  if (!res.ok) { const msg = await res.text().catch(() => \"生成失败\"); throw new Error(msg || \"生成失败\"); }\n                  const data = await res.json();\n                  setPlan(data);\n                  try { localStorage.setItem(\"lastPlan\", JSON.stringify(data)); localStorage.setItem(\"lastPrefs\", JSON.stringify({ pace, interests, ...(budgetInput.trim() ? { budgetTotal: Number(budgetInput) } : {}) })); } catch {}\n                  setShowPrefs(false);\n                } catch (e: any) {\n                  setGenError(e?.message || \"生成失败\");\n                } finally {\n                  setGenerating(false);\n                }\n              }} disabled={generating}>{generating?\"生成中...\":\"重新生成\"}</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}